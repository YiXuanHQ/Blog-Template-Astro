---
title: çº¦æŸä¸æ•°æ®å®Œæ•´æ€§
prevChapter: "java-backend/mysql/ç¬¬02ç« -è¿›é˜¶ç¯‡/01-å‡½æ•°è¯¦è§£"
nextChapter: "java-backend/mysql/ç¬¬02ç« -è¿›é˜¶ç¯‡/03-å¤šè¡¨æŸ¥è¯¢ä¸è¿æ¥"
parentChapter: "java-backend/mysql/README"
---
# çº¦æŸä¸æ•°æ®å®Œæ•´æ€§

> çº¦æŸæ˜¯ä¿è¯æ•°æ®å‡†ç¡®æ€§å’Œä¸€è‡´æ€§çš„é‡è¦æœºåˆ¶ã€‚æœ¬ç« å°†æ·±å…¥è®²è§£MySQLä¸­çš„å„ç§çº¦æŸç±»å‹åŠå…¶åº”ç”¨ï¼ŒæŒæ¡çº¦æŸæ˜¯è®¾è®¡é«˜è´¨é‡æ•°æ®åº“çš„å…³é”®ã€‚

## âš¡ å¿«é€Ÿå‚è€ƒ

- **ä¸»é”®çº¦æŸï¼ˆPRIMARY KEYï¼‰**ï¼šå”¯ä¸€æ ‡è¯†ï¼Œéç©ºä¸”å”¯ä¸€ï¼Œä¸€ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®
- **å¤–é”®çº¦æŸï¼ˆFOREIGN KEYï¼‰**ï¼šå»ºç«‹è¡¨é—´å…³ç³»ï¼Œä¿è¯å¼•ç”¨å®Œæ•´æ€§ï¼Œæ”¯æŒçº§è”æ“ä½œ
- **å”¯ä¸€çº¦æŸï¼ˆUNIQUEï¼‰**ï¼šä¿è¯æ•°æ®å”¯ä¸€ï¼Œå¯ä»¥ä¸ºNULLï¼Œä¸€ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªå”¯ä¸€çº¦æŸ
- **éç©ºçº¦æŸï¼ˆNOT NULLï¼‰**ï¼šä¸å…è®¸ä¸ºNULLï¼Œä¿è¯å­—æ®µå¿…é¡»æœ‰å€¼
- **é»˜è®¤çº¦æŸï¼ˆDEFAULTï¼‰**ï¼šè®¾ç½®å­—æ®µé»˜è®¤å€¼ï¼Œæ’å…¥æ•°æ®æ—¶æœªæŒ‡å®šåˆ™ä½¿ç”¨é»˜è®¤å€¼
- **æ£€æŸ¥çº¦æŸï¼ˆCHECKï¼‰**ï¼šä¿è¯å­—æ®µå€¼æ»¡è¶³æ¡ä»¶ï¼ŒMySQL 8.0.16+æ”¯æŒ
- **çº¦æŸä½œç”¨**ï¼šä¿è¯æ•°æ®å‡†ç¡®æ€§ã€ç»´æŠ¤æ•°æ®ä¸€è‡´æ€§ã€å»ºç«‹è¡¨é—´å…³ç³»ã€æé«˜æ•°æ®è´¨é‡

## ğŸ“š å­¦ä¹ ç›®æ ‡

1. ç†è§£çº¦æŸçš„æ¦‚å¿µå’Œä½œç”¨ï¼ŒæŒæ¡çº¦æŸåœ¨æ•°æ®åº“è®¾è®¡ä¸­çš„é‡è¦æ€§
2. ç†Ÿç»ƒæŒæ¡å„ç§çº¦æŸç±»å‹çš„è¯­æ³•å’Œä½¿ç”¨æ–¹æ³•
3. æŒæ¡ä¸»é”®çº¦æŸå’Œå¤–é”®çº¦æŸçš„è®¾è®¡åŸåˆ™å’Œåº”ç”¨åœºæ™¯
4. ç†è§£å¤–é”®çº¦æŸçš„çº§è”æ“ä½œï¼ˆCASCADEã€SET NULLã€RESTRICTï¼‰
5. èƒ½å¤Ÿæ ¹æ®ä¸šåŠ¡éœ€æ±‚ä¸ºè¡¨è®¾è®¡åˆé€‚çš„çº¦æŸ
6. æŒæ¡çº¦æŸçš„æ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤æ“ä½œ
7. ç†è§£çº¦æŸå¯¹æ•°æ®å®Œæ•´æ€§çš„ä¿éšœä½œç”¨

## ä¸€ã€çº¦æŸæ¦‚è¿°

### 1.1 ä»€ä¹ˆæ˜¯çº¦æŸï¼Ÿ

**çº¦æŸï¼ˆConstraintï¼‰** æ˜¯ä½œç”¨äºè¡¨ä¸­å­—æ®µä¸Šçš„è§„åˆ™ï¼Œç”¨äºé™åˆ¶å­˜å‚¨åœ¨è¡¨ä¸­çš„æ•°æ®ï¼Œä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ã€æœ‰æ•ˆæ€§å’Œå®Œæ•´æ€§ã€‚

### 1.2 çº¦æŸçš„åˆ†ç±»

| çº¦æŸç±»å‹ | å…³é”®å­— | è¯´æ˜ |
|---------|--------|------|
| **ä¸»é”®çº¦æŸ** | `PRIMARY KEY` | å”¯ä¸€æ ‡è¯†ï¼Œéç©ºä¸”å”¯ä¸€ |
| **å¤–é”®çº¦æŸ** | `FOREIGN KEY` | å»ºç«‹è¡¨é—´å…³ç³»ï¼Œä¿è¯å¼•ç”¨å®Œæ•´æ€§ |
| **å”¯ä¸€çº¦æŸ** | `UNIQUE` | ä¿è¯æ•°æ®å”¯ä¸€ï¼Œå¯ä»¥ä¸ºNULL |
| **éç©ºçº¦æŸ** | `NOT NULL` | ä¸å…è®¸ä¸ºNULL |
| **é»˜è®¤çº¦æŸ** | `DEFAULT` | è®¾ç½®é»˜è®¤å€¼ |
| **æ£€æŸ¥çº¦æŸ** | `CHECK` | ä¿è¯å­—æ®µå€¼æ»¡è¶³æ¡ä»¶ï¼ˆMySQL 8.0.16+ï¼‰ |

### 1.3 çº¦æŸçš„ä½œç”¨

- âœ… **ä¿è¯æ•°æ®å‡†ç¡®æ€§**ï¼šé˜²æ­¢éæ³•æ•°æ®æ’å…¥
- âœ… **ç»´æŠ¤æ•°æ®ä¸€è‡´æ€§**ï¼šç¡®ä¿æ•°æ®ç¬¦åˆä¸šåŠ¡è§„åˆ™
- âœ… **å»ºç«‹è¡¨é—´å…³ç³»**ï¼šé€šè¿‡å¤–é”®ç»´æŠ¤å…³è”
- âœ… **æé«˜æ•°æ®è´¨é‡**ï¼šåœ¨æ•°æ®åº“å±‚é¢æŠŠå…³

### 1.4 çº¦æŸæ¼”ç¤º

å®Œæˆè¡¨ç»“æ„çš„åˆ›å»ºã€‚éœ€æ±‚å¦‚ä¸‹ï¼š

**å»ºè¡¨è¯­å¥ï¼š**

åœ¨ä¸ºå­—æ®µæ·»åŠ çº¦æŸæ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å­—æ®µä¹‹ååŠ ä¸Šçº¦æŸçš„å…³é”®å­—å³å¯ï¼Œéœ€è¦å…³æ³¨å…¶è¯­æ³•ã€‚

```sql
-- åˆ›å»ºç”¨æˆ·è¡¨ï¼ŒåŒ…å«å¤šç§çº¦æŸ
CREATE TABLE tb_user(
    id int AUTO_INCREMENT PRIMARY KEY COMMENT 'IDå”¯ä¸€æ ‡è¯†',
    name varchar(10) NOT NULL UNIQUE COMMENT 'å§“å',
    age int CHECK (age > 0 AND age <= 120) COMMENT 'å¹´é¾„',
    status char(1) DEFAULT '1' COMMENT 'çŠ¶æ€',
    gender char(1) COMMENT 'æ€§åˆ«'
);
```

**æ³¨æ„**ï¼šæ£€æŸ¥çº¦æŸéœ€è¦ä½¿ç”¨ `AND` è€Œä¸æ˜¯ `&&`ï¼Œè¿™æ˜¯SQLæ ‡å‡†è¯­æ³•ã€‚

**çº¦æŸè¯´æ˜ï¼š**
- `id`ï¼šä¸»é”®çº¦æŸ + è‡ªå¢ + æ³¨é‡Š
- `name`ï¼šéç©ºçº¦æŸ + å”¯ä¸€çº¦æŸ + æ³¨é‡Š
- `age`ï¼šæ£€æŸ¥çº¦æŸï¼ˆå¹´é¾„èŒƒå›´0-120ï¼‰+ æ³¨é‡Š
- `status`ï¼šé»˜è®¤çº¦æŸï¼ˆé»˜è®¤ä¸º'1'ï¼‰+ æ³¨é‡Š
- `gender`ï¼šæ— çº¦æŸï¼Œå¯ä¸ºç©º

**æµ‹è¯•æ•°æ®ï¼š**

æ‰§è¡Œä¸Šé¢çš„SQLæŠŠè¡¨ç»“æ„åˆ›å»ºå®Œæˆï¼Œç„¶åé€šè¿‡ä¸€ç»„æ•°æ®è¿›è¡Œæµ‹è¯•ï¼ŒéªŒè¯çº¦æŸæ˜¯å¦å¯ä»¥ç”Ÿæ•ˆã€‚

```sql
-- 1. æ­£å¸¸æ’å…¥æ•°æ®
INSERT INTO tb_user(name,age,status,gender) VALUES 
('Tom1',19,'1','ç”·'),
('Tom2',25,'0','ç”·');

-- 2. æ­£å¸¸æ’å…¥å•æ¡æ•°æ®
INSERT INTO tb_user(name,age,status,gender) VALUES ('Tom3',19,'1','ç”·');

-- 3. æµ‹è¯•éç©ºçº¦æŸï¼ˆä¼šå¤±è´¥ï¼šnameä¸èƒ½ä¸ºNULLï¼‰
INSERT INTO tb_user(name,age,status,gender) VALUES (null,19,'1','ç”·');

-- 4. æµ‹è¯•å”¯ä¸€çº¦æŸï¼ˆä¼šå¤±è´¥ï¼šname='Tom3'å·²å­˜åœ¨ï¼‰
INSERT INTO tb_user(name,age,status,gender) VALUES ('Tom3',19,'1','ç”·');

-- 5. æ­£å¸¸æ’å…¥ï¼ˆå¹´é¾„åœ¨èŒƒå›´å†…ï¼‰
INSERT INTO tb_user(name,age,status,gender) VALUES ('Tom4',80,'1','ç”·');

-- 6. æµ‹è¯•æ£€æŸ¥çº¦æŸï¼ˆä¼šå¤±è´¥ï¼šage=-1ä¸åœ¨0-120èŒƒå›´å†…ï¼‰
INSERT INTO tb_user(name,age,status,gender) VALUES ('Tom5',-1,'1','ç”·');

-- 7. æµ‹è¯•æ£€æŸ¥çº¦æŸï¼ˆä¼šå¤±è´¥ï¼šage=121ä¸åœ¨0-120èŒƒå›´å†…ï¼‰
INSERT INTO tb_user(name,age,status,gender) VALUES ('Tom5',121,'1','ç”·');

-- 8. æµ‹è¯•é»˜è®¤çº¦æŸï¼ˆstatusæœªæŒ‡å®šï¼Œä½¿ç”¨é»˜è®¤å€¼'1'ï¼‰
INSERT INTO tb_user(name,age,gender) VALUES ('Tom5',120,'ç”·');
```

**æµ‹è¯•ç»“æœè¯´æ˜ï¼š**
- âœ… æ­£å¸¸æ’å…¥ï¼šç¬¦åˆæ‰€æœ‰çº¦æŸæ¡ä»¶çš„æ•°æ®å¯ä»¥æˆåŠŸæ’å…¥
- âŒ è¿åéç©ºçº¦æŸï¼šnameä¸ºNULLä¼šå¤±è´¥
- âŒ è¿åå”¯ä¸€çº¦æŸï¼šé‡å¤çš„nameå€¼ä¼šå¤±è´¥
- âŒ è¿åæ£€æŸ¥çº¦æŸï¼šageä¸åœ¨0-120èŒƒå›´å†…ä¼šå¤±è´¥
- âœ… é»˜è®¤å€¼ç”Ÿæ•ˆï¼šæœªæŒ‡å®šstatusæ—¶ä½¿ç”¨é»˜è®¤å€¼'1'

**å›¾å½¢åŒ–ç•Œé¢åˆ›å»ºçº¦æŸï¼š**

å¦‚æœé€šè¿‡å›¾å½¢åŒ–ç•Œé¢ï¼ˆå¦‚DataGripï¼‰æ¥åˆ›å»ºè¡¨ç»“æ„ï¼Œåªéœ€è¦åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œæ ¹æ®æˆ‘ä»¬çš„éœ€è¦é€‰æ‹©å¯¹åº”çš„çº¦æŸå³å¯ã€‚

![image-20260111173818891](https://raw.gitcode.com/YiXuanHQ/YiXuan-Blog-Image/raw/main/tutorials/java-backend/mysql/image-20260111173818891.png)

---

## äºŒã€ä¸»é”®çº¦æŸ

### 2.1 ä¸»é”®çš„ç‰¹ç‚¹

- ğŸ”‘ **å”¯ä¸€æ ‡è¯†**ï¼šæ¯æ¡è®°å½•çš„ä¸»é”®å€¼å¿…é¡»å”¯ä¸€
- âŒ **éç©º**ï¼šä¸»é”®å€¼ä¸èƒ½ä¸ºNULL
- ğŸ¯ **ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®**
- âš¡ **è‡ªåŠ¨åˆ›å»ºç´¢å¼•**ï¼šæé«˜æŸ¥è¯¢æ•ˆç‡

### 2.2 åˆ›å»ºä¸»é”®

#### æ–¹å¼ä¸€ï¼šåˆ›å»ºè¡¨æ—¶å®šä¹‰

```sql
-- å•å­—æ®µä¸»é”®
CREATE TABLE students (
    id INT PRIMARY KEY,
    name VARCHAR(50),
    age INT
);

-- æˆ–ä½¿ç”¨AUTO_INCREMENTè‡ªå¢
CREATE TABLE students (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50),
    age INT
);

-- åœ¨å­—æ®µåˆ—è¡¨åå®šä¹‰
CREATE TABLE students (
    id INT,
    name VARCHAR(50),
    age INT,
    PRIMARY KEY (id)
);

-- è”åˆä¸»é”®ï¼ˆå¤šä¸ªå­—æ®µç»„åˆï¼‰
CREATE TABLE student_courses (
    student_id INT,
    course_id INT,
    score DECIMAL(5,2),
    PRIMARY KEY (student_id, course_id)
);
```

#### æ–¹å¼äºŒï¼šä¿®æ”¹è¡¨æ·»åŠ ä¸»é”®

```sql
-- æ·»åŠ ä¸»é”®
ALTER TABLE students ADD PRIMARY KEY (id);

-- æ·»åŠ è‡ªå¢ä¸»é”®
ALTER TABLE students 
MODIFY id INT AUTO_INCREMENT,
ADD PRIMARY KEY (id);
```

### 2.3 åˆ é™¤ä¸»é”®

```sql
-- å…ˆåˆ é™¤è‡ªå¢å±æ€§
ALTER TABLE students MODIFY id INT;

-- å†åˆ é™¤ä¸»é”®
ALTER TABLE students DROP PRIMARY KEY;
```

### 2.4 AUTO_INCREMENTè‡ªå¢

```sql
-- åˆ›å»ºè‡ªå¢ä¸»é”®
CREATE TABLE orders (
    order_id INT PRIMARY KEY AUTO_INCREMENT,
    customer_name VARCHAR(50),
    order_date DATE
);

-- æ’å…¥æ•°æ®ï¼ˆè‡ªåŠ¨ç”ŸæˆIDï¼‰
INSERT INTO orders (customer_name, order_date) 
VALUES ('å¼ ä¸‰', '2024-01-01');

-- æŒ‡å®šèµ·å§‹å€¼
ALTER TABLE orders AUTO_INCREMENT = 1000;

-- æŸ¥è¯¢ä¸‹ä¸€ä¸ªè‡ªå¢å€¼
SELECT AUTO_INCREMENT 
FROM information_schema.TABLES 
WHERE TABLE_NAME = 'orders';
```

---

## ä¸‰ã€å¤–é”®çº¦æŸ

### 3.1 å¤–é”®çš„ä»‹ç»

**å¤–é”®**ï¼šç”¨æ¥è®©ä¸¤å¼ è¡¨çš„æ•°æ®ä¹‹é—´å»ºç«‹è¿æ¥ï¼Œä»è€Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚

**ç¤ºä¾‹å…³ç³»**ï¼š

å·¦ä¾§çš„empè¡¨æ˜¯å‘˜å·¥è¡¨ï¼Œé‡Œé¢å­˜å‚¨å‘˜å·¥çš„åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…å«å‘˜å·¥çš„IDã€å§“åã€å¹´é¾„ã€èŒä½ã€è–ªèµ„ã€å…¥èŒæ—¥æœŸã€ä¸Šçº§ä¸»ç®¡IDã€éƒ¨é—¨IDï¼Œåœ¨å‘˜å·¥çš„ä¿¡æ¯ä¸­å­˜å‚¨çš„æ˜¯éƒ¨é—¨çš„ID `dept_id`ï¼Œè€Œè¿™ä¸ªéƒ¨é—¨çš„IDæ˜¯å…³è”çš„éƒ¨é—¨è¡¨deptçš„ä¸»é”®idï¼Œé‚£empè¡¨çš„dept_idå°±æ˜¯å¤–é”®ï¼Œå…³è”çš„æ˜¯å¦ä¸€å¼ è¡¨çš„ä¸»é”®ã€‚

![image-20260111175908344](https://raw.gitcode.com/YiXuanHQ/YiXuan-Blog-Image/raw/main/tutorials/java-backend/mysql/image-20260111175908344.png)

**æ³¨æ„**ï¼šç›®å‰ä¸Šè¿°ä¸¤å¼ è¡¨ï¼Œåªæ˜¯åœ¨é€»è¾‘ä¸Šå­˜åœ¨è¿™æ ·ä¸€å±‚å…³ç³»ï¼›åœ¨æ•°æ®åº“å±‚é¢ï¼Œå¹¶æœªå»ºç«‹å¤–é”®å…³è”ï¼Œæ‰€ä»¥æ˜¯æ— æ³•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§çš„ã€‚

**é—®é¢˜æ¼”ç¤ºï¼š**

æ²¡æœ‰æ•°æ®åº“å¤–é”®å…³è”çš„æƒ…å†µä¸‹ï¼Œæ˜¯æ— æ³•ä¿è¯æ•°æ®ä¸€è‡´æ€§å’Œå®Œæ•´æ€§çš„ï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ã€‚

**å‡†å¤‡æ•°æ®ï¼š**

```sql
-- åˆ›å»ºéƒ¨é—¨è¡¨
CREATE TABLE dept(
    id int auto_increment comment 'ID' primary key,
    name varchar(50) not null comment 'éƒ¨é—¨åç§°'
) comment 'éƒ¨é—¨è¡¨';

-- æ’å…¥éƒ¨é—¨æ•°æ®
INSERT INTO dept (id, name) VALUES 
(1, 'ç ”å‘éƒ¨'), 
(2, 'å¸‚åœºéƒ¨'),
(3, 'è´¢åŠ¡éƒ¨'), 
(4, 'é”€å”®éƒ¨'), 
(5, 'æ€»ç»åŠ');

-- åˆ›å»ºå‘˜å·¥è¡¨ï¼ˆæ­¤æ—¶è¿˜æœªæ·»åŠ å¤–é”®çº¦æŸï¼‰
CREATE TABLE emp(
    id int auto_increment comment 'ID' primary key,
    name varchar(50) not null comment 'å§“å',
    age int comment 'å¹´é¾„',
    job varchar(20) comment 'èŒä½',
    salary int comment 'è–ªèµ„',
    entrydate date comment 'å…¥èŒæ—¶é—´',
    managerid int comment 'ç›´å±é¢†å¯¼ID',
    dept_id int comment 'éƒ¨é—¨ID'
) comment 'å‘˜å·¥è¡¨';

-- æ’å…¥å‘˜å·¥æ•°æ®
INSERT INTO emp (id, name, age, job, salary, entrydate, managerid, dept_id) VALUES
(1, 'é‡‘åº¸', 66, 'æ€»è£', 20000, '2000-01-01', null, 5),
(2, 'å¼ æ— å¿Œ', 20, 'é¡¹ç›®ç»ç†', 12500, '2005-12-05', 1, 1),
(3, 'æ¨é€', 33, 'å¼€å‘', 8400, '2000-11-03', 2, 1),
(4, 'éŸ¦ä¸€ç¬‘', 48, 'å¼€å‘', 11000, '2002-02-05', 2, 1),
(5, 'å¸¸é‡æ˜¥', 43, 'å¼€å‘', 10500, '2004-09-07', 3, 1),
(6, 'å°æ˜­', 19, 'ç¨‹åºå‘˜é¼“åŠ±å¸ˆ', 6600, '2004-10-12', 2, 1);
```

![image-20260111185708272](https://raw.gitcode.com/YiXuanHQ/YiXuan-Blog-Image/raw/main/tutorials/java-backend/mysql/image-20260111185708272.png)

**æµ‹è¯•åˆ é™¤éƒ¨é—¨ï¼š**

```sql
-- åˆ é™¤idä¸º1çš„éƒ¨é—¨ä¿¡æ¯
DELETE FROM dept WHERE id = 1;
```

**ç»“æœåˆ†æï¼š**

åˆ é™¤æˆåŠŸï¼Œä½†åˆ é™¤æˆåŠŸä¹‹åï¼Œéƒ¨é—¨è¡¨ä¸å­˜åœ¨idä¸º1çš„éƒ¨é—¨ï¼Œè€Œåœ¨empè¡¨ä¸­è¿˜æœ‰å¾ˆå¤šå‘˜å·¥ï¼Œå…³è”çš„ä¸ºidä¸º1çš„éƒ¨é—¨ï¼Œæ­¤æ—¶å°±å‡ºç°äº†æ•°æ®çš„ä¸å®Œæ•´æ€§ã€‚

![image-20260111185657626](https://raw.gitcode.com/YiXuanHQ/YiXuan-Blog-Image/raw/main/tutorials/java-backend/mysql/image-20260111185657626.png)

è€Œè¦æƒ³è§£å†³è¿™ä¸ªé—®é¢˜å°±å¾—é€šè¿‡æ•°æ®åº“çš„**å¤–é”®çº¦æŸ**ã€‚

### 3.2 å¤–é”®è¯­æ³•

#### 3.2.1 æ·»åŠ å¤–é”®

**æ–¹å¼ä¸€ï¼šåˆ›å»ºè¡¨æ—¶å®šä¹‰**

```sql
CREATE TABLE è¡¨å(
    å­—æ®µå æ•°æ®ç±»å‹,
    ...
    [CONSTRAINT] [å¤–é”®åç§°] FOREIGN KEY (å¤–é”®å­—æ®µå) REFERENCES ä¸»è¡¨ (ä¸»è¡¨åˆ—å)
);
```

**ç¤ºä¾‹ï¼š**

```sql
-- å…ˆåˆ›å»ºçˆ¶è¡¨ï¼ˆè¢«å¼•ç”¨çš„è¡¨ï¼‰
CREATE TABLE departments (
    dept_id INT PRIMARY KEY AUTO_INCREMENT,
    dept_name VARCHAR(50) NOT NULL
);

-- å†åˆ›å»ºå­è¡¨ï¼ˆå¼•ç”¨çš„è¡¨ï¼‰ï¼Œåœ¨åˆ›å»ºæ—¶å®šä¹‰å¤–é”®
CREATE TABLE employees (
    emp_id INT PRIMARY KEY AUTO_INCREMENT,
    emp_name VARCHAR(50) NOT NULL,
    dept_id INT,
    FOREIGN KEY (dept_id) REFERENCES departments(dept_id)
);
```

**æ–¹å¼äºŒï¼šä¿®æ”¹è¡¨æ·»åŠ å¤–é”®**

```sql
ALTER TABLE è¡¨å 
ADD CONSTRAINT å¤–é”®åç§° 
FOREIGN KEY (å¤–é”®å­—æ®µå) REFERENCES ä¸»è¡¨ (ä¸»è¡¨åˆ—å);
```

**ç¤ºä¾‹ï¼š**

ä¸ºempè¡¨çš„dept_idå­—æ®µæ·»åŠ å¤–é”®çº¦æŸï¼Œå…³è”deptè¡¨çš„ä¸»é”®idã€‚

```sql
-- ä¸ºempè¡¨çš„dept_idå­—æ®µæ·»åŠ å¤–é”®çº¦æŸ
ALTER TABLE emp 
ADD CONSTRAINT fk_emp_dept_id 
FOREIGN KEY (dept_id) REFERENCES dept(id);
```

![image-20260111185754522](https://raw.gitcode.com/YiXuanHQ/YiXuan-Blog-Image/raw/main/tutorials/java-backend/mysql/image-20260111185754522.png)

**æµ‹è¯•å¤–é”®çº¦æŸï¼š**

æ·»åŠ äº†å¤–é”®çº¦æŸä¹‹åï¼Œæˆ‘ä»¬å†åˆ°deptè¡¨ï¼ˆçˆ¶è¡¨ï¼‰åˆ é™¤idä¸º1çš„è®°å½•ï¼Œç„¶åçœ‹ä¸€ä¸‹ä¼šå‘ç”Ÿä»€ä¹ˆç°è±¡ã€‚

```sql
-- å°è¯•åˆ é™¤deptè¡¨ä¸­idä¸º1çš„è®°å½•
DELETE FROM dept WHERE id = 1;
```

**ç»“æœ**ï¼šæ­¤æ—¶å°†ä¼šæŠ¥é”™ï¼Œä¸èƒ½åˆ é™¤æˆ–æ›´æ–°çˆ¶è¡¨è®°å½•ï¼Œå› ä¸ºå­˜åœ¨å¤–é”®çº¦æŸã€‚è¿™æ ·å°±ä¿è¯äº†æ•°æ®çš„å®Œæ•´æ€§ã€‚

![image-20260111185808399](https://raw.gitcode.com/YiXuanHQ/YiXuan-Blog-Image/raw/main/tutorials/java-backend/mysql/image-20260111185808399.png)

#### 3.2.2 åˆ é™¤å¤–é”®

**è¯­æ³•ï¼š**

```sql
ALTER TABLE è¡¨å DROP FOREIGN KEY å¤–é”®åç§°;
```

**ç¤ºä¾‹ï¼š**

åˆ é™¤empè¡¨çš„å¤–é”®fk_emp_dept_idã€‚

```sql
-- åˆ é™¤empè¡¨çš„å¤–é”®
ALTER TABLE emp DROP FOREIGN KEY fk_emp_dept_id;
```

**æŸ¥çœ‹å¤–é”®åç§°ï¼š**

```sql
-- æŸ¥çœ‹è¡¨çš„åˆ›å»ºè¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°å¤–é”®åç§°
SHOW CREATE TABLE emp;
```

### 3.3 åˆ é™¤/æ›´æ–°è¡Œä¸º

æ·»åŠ äº†å¤–é”®ä¹‹åï¼Œå†åˆ é™¤çˆ¶è¡¨æ•°æ®æ—¶äº§ç”Ÿçš„çº¦æŸè¡Œä¸ºï¼Œæˆ‘ä»¬å°±ç§°ä¸º**åˆ é™¤/æ›´æ–°è¡Œä¸º**ã€‚å…·ä½“çš„åˆ é™¤/æ›´æ–°è¡Œä¸ºæœ‰ä»¥ä¸‹å‡ ç§ï¼š

| è¡Œä¸º | è¯´æ˜ |
|------|------|
| **NO ACTION** | å½“åœ¨çˆ¶è¡¨ä¸­åˆ é™¤/æ›´æ–°å¯¹åº”è®°å½•æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥è¯¥è®°å½•æ˜¯å¦æœ‰å¯¹åº”å¤–é”®ï¼Œå¦‚æœæœ‰åˆ™ä¸å…è®¸åˆ é™¤/æ›´æ–°ï¼ˆä¸ RESTRICT ä¸€è‡´ï¼‰ï¼Œ**é»˜è®¤è¡Œä¸º** |
| **RESTRICT** | å½“åœ¨çˆ¶è¡¨ä¸­åˆ é™¤/æ›´æ–°å¯¹åº”è®°å½•æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥è¯¥è®°å½•æ˜¯å¦æœ‰å¯¹åº”å¤–é”®ï¼Œå¦‚æœæœ‰åˆ™ä¸å…è®¸åˆ é™¤/æ›´æ–°ï¼ˆä¸ NO ACTION ä¸€è‡´ï¼‰ï¼Œ**é»˜è®¤è¡Œä¸º** |
| **CASCADE** | å½“åœ¨çˆ¶è¡¨ä¸­åˆ é™¤/æ›´æ–°å¯¹åº”è®°å½•æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥è¯¥è®°å½•æ˜¯å¦æœ‰å¯¹åº”å¤–é”®ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä¹Ÿåˆ é™¤/æ›´æ–°å¤–é”®åœ¨å­è¡¨ä¸­çš„è®°å½• |
| **SET NULL** | å½“åœ¨çˆ¶è¡¨ä¸­åˆ é™¤å¯¹åº”è®°å½•æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥è¯¥è®°å½•æ˜¯å¦æœ‰å¯¹åº”å¤–é”®ï¼Œå¦‚æœæœ‰åˆ™è®¾ç½®å­è¡¨ä¸­è¯¥å¤–é”®å€¼ä¸ºnullï¼ˆè¿™å°±è¦æ±‚è¯¥å¤–é”®å…è®¸å–nullï¼‰ |
| **SET DEFAULT** | çˆ¶è¡¨æœ‰å˜æ›´æ—¶ï¼Œå­è¡¨å°†å¤–é”®åˆ—è®¾ç½®æˆä¸€ä¸ªé»˜è®¤çš„å€¼ï¼ˆInnodbä¸æ”¯æŒï¼‰ |

**è¯­æ³•ï¼š**

```sql
ALTER TABLE è¡¨å 
ADD CONSTRAINT å¤–é”®åç§° 
FOREIGN KEY (å¤–é”®å­—æ®µ) REFERENCES ä¸»è¡¨å (ä¸»è¡¨å­—æ®µå) 
ON UPDATE CASCADE 
ON DELETE CASCADE;
```

#### 3.3.1 CASCADEï¼ˆçº§è”æ“ä½œï¼‰

**ç‰¹ç‚¹**ï¼šçˆ¶è¡¨è®°å½•åˆ é™¤/æ›´æ–°æ—¶ï¼Œå­è¡¨å…³è”è®°å½•åŒæ­¥åˆ é™¤/æ›´æ–°ã€‚

**ç¤ºä¾‹ï¼š**

```sql
-- æ·»åŠ å¤–é”®çº¦æŸï¼Œè®¾ç½®çº§è”æ›´æ–°å’Œçº§è”åˆ é™¤
ALTER TABLE emp 
ADD CONSTRAINT fk_emp_dept_id 
FOREIGN KEY (dept_id) REFERENCES dept(id) 
ON UPDATE CASCADE 
ON DELETE CASCADE;
```

**æµ‹è¯•1ï¼šçº§è”æ›´æ–°**

![image-20260111185841600](https://raw.gitcode.com/YiXuanHQ/YiXuan-Blog-Image/raw/main/tutorials/java-backend/mysql/image-20260111185841600.png)

```sql
-- A. ä¿®æ”¹çˆ¶è¡¨idä¸º1çš„è®°å½•ï¼Œå°†idä¿®æ”¹ä¸º6
UPDATE dept SET id = 6 WHERE id = 1;
```

**ç»“æœ**ï¼šæˆ‘ä»¬å‘ç°ï¼ŒåŸæ¥åœ¨å­è¡¨ä¸­dept_idå€¼ä¸º1çš„è®°å½•ï¼Œç°åœ¨ä¹Ÿå˜ä¸º6äº†ï¼Œè¿™å°±æ˜¯cascadeçº§è”çš„æ•ˆæœã€‚

> **æ³¨æ„**ï¼šåœ¨ä¸€èˆ¬çš„ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œä¸ä¼šä¿®æ”¹ä¸€å¼ è¡¨çš„ä¸»é”®å€¼ã€‚



**æµ‹è¯•2ï¼šçº§è”åˆ é™¤**

![image-20260111185847885](https://raw.gitcode.com/YiXuanHQ/YiXuan-Blog-Image/raw/main/tutorials/java-backend/mysql/image-20260111185847885.png)

```sql
-- B. åˆ é™¤çˆ¶è¡¨idä¸º6çš„è®°å½•
DELETE FROM dept WHERE id = 6;
```

**ç»“æœ**ï¼šæˆ‘ä»¬å‘ç°ï¼Œçˆ¶è¡¨çš„æ•°æ®åˆ é™¤æˆåŠŸäº†ï¼Œä½†æ˜¯å­è¡¨ä¸­å…³è”çš„è®°å½•ä¹Ÿè¢«çº§è”åˆ é™¤äº†ã€‚



#### 3.3.2 SET NULLï¼ˆè®¾ç½®ä¸ºNULLï¼‰

**ç‰¹ç‚¹**ï¼šçˆ¶è¡¨è®°å½•åˆ é™¤æ—¶ï¼Œå­è¡¨å¤–é”®å­—æ®µè®¾ç½®ä¸ºNULLï¼ˆéœ€è¦å¤–é”®å­—æ®µå…è®¸ä¸ºNULLï¼‰ã€‚

**ç¤ºä¾‹ï¼š**

åœ¨è¿›è¡Œæµ‹è¯•ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆéœ€è¦åˆ é™¤ä¸Šé¢å»ºç«‹çš„å¤–é”® `fk_emp_dept_id`ã€‚ç„¶åå†é€šè¿‡æ•°æ®è„šæœ¬ï¼Œå°†empã€deptè¡¨çš„æ•°æ®æ¢å¤äº†ã€‚

```sql
-- å…ˆåˆ é™¤ä¹‹å‰çš„å¤–é”®
ALTER TABLE emp DROP FOREIGN KEY fk_emp_dept_id;

-- æ¢å¤æ•°æ®ï¼ˆé‡æ–°æ’å…¥ï¼‰
-- ... é‡æ–°æ‰§è¡Œå‰é¢çš„INSERTè¯­å¥ ...

-- æ·»åŠ å¤–é”®çº¦æŸï¼Œè®¾ç½®æ›´æ–°å’Œåˆ é™¤æ—¶è®¾ç½®ä¸ºNULL
ALTER TABLE emp 
ADD CONSTRAINT fk_emp_dept_id 
FOREIGN KEY (dept_id) REFERENCES dept(id) 
ON UPDATE SET NULL 
ON DELETE SET NULL;
```

**æµ‹è¯•ï¼š**

![image-20260111190029057](https://raw.gitcode.com/YiXuanHQ/YiXuan-Blog-Image/raw/main/tutorials/java-backend/mysql/image-20260111190029057.png)

```sql
-- åˆ é™¤idä¸º1çš„éƒ¨é—¨æ•°æ®
DELETE FROM dept WHERE id = 1;
```

**ç»“æœ**ï¼š

æˆ‘ä»¬å‘ç°çˆ¶è¡¨çš„è®°å½•æ˜¯å¯ä»¥æ­£å¸¸çš„åˆ é™¤çš„ï¼Œçˆ¶è¡¨çš„æ•°æ®åˆ é™¤ä¹‹åï¼Œå†æ‰“å¼€å­è¡¨empï¼Œæˆ‘ä»¬å‘ç°å­è¡¨empçš„dept_idå­—æ®µï¼ŒåŸæ¥dept_idä¸º1çš„æ•°æ®ï¼Œç°åœ¨éƒ½è¢«ç½®ä¸ºNULLäº†ã€‚

![image-20260111190037524](https://raw.gitcode.com/YiXuanHQ/YiXuan-Blog-Image/raw/main/tutorials/java-backend/mysql/image-20260111190037524.png)

è¿™å°±æ˜¯**SET NULL**è¿™ç§åˆ é™¤/æ›´æ–°è¡Œä¸ºçš„æ•ˆæœã€‚

### 3.4 å¤–é”®çš„çº§è”æ“ä½œæ€»ç»“

**åˆ é™¤/æ›´æ–°è¡Œä¸ºå¯¹æ¯”è¡¨ï¼š**

| é€‰é¡¹ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| `RESTRICT` / `NO ACTION` | æœ‰å­è¡¨è®°å½•æ—¶ï¼Œæ‹’ç»çˆ¶è¡¨åˆ é™¤/æ›´æ–°ï¼ˆé»˜è®¤ï¼‰ | ä¿æŠ¤å…³é”®æ•°æ®ï¼Œé˜²æ­¢è¯¯åˆ  |
| `CASCADE` | çˆ¶è¡¨åˆ é™¤/æ›´æ–°æ—¶ï¼Œå­è¡¨åŒæ­¥åˆ é™¤/æ›´æ–° | çº§è”åˆ é™¤ç›¸å…³æ•°æ® |
| `SET NULL` | çˆ¶è¡¨åˆ é™¤/æ›´æ–°æ—¶ï¼Œå­è¡¨å¤–é”®è®¾ä¸ºNULL | ä¿ç•™å­è¡¨æ•°æ®ï¼Œä½†è§£é™¤å…³è” |
| `SET DEFAULT` | è®¾ç½®ä¸ºé»˜è®¤å€¼ | InnoDBä¸æ”¯æŒ |

**ä½¿ç”¨å»ºè®®ï¼š**
- âœ… é»˜è®¤è¡Œä¸ºï¼ˆRESTRICTï¼‰ï¼šä¿æŠ¤æ•°æ®å®Œæ•´æ€§ï¼Œé˜²æ­¢è¯¯æ“ä½œ
- âœ… CASCADEï¼šè°¨æ…ä½¿ç”¨ï¼Œå¯èƒ½å¯¼è‡´çº§è”åˆ é™¤å¤§é‡æ•°æ®
- âœ… SET NULLï¼šéœ€è¦å­è¡¨å¤–é”®å­—æ®µå…è®¸ä¸ºNULL

### 3.5 å¤–é”®ä½¿ç”¨æ³¨æ„äº‹é¡¹

âš ï¸ **æ³¨æ„**ï¼š
1. å¤–é”®å­—æ®µçš„æ•°æ®ç±»å‹å¿…é¡»ä¸ä¸»è¡¨ä¸»é”®ä¸€è‡´
2. å¤–é”®å­—æ®µå¯ä»¥ä¸ºNULLï¼ˆé™¤éè®¾ç½®NOT NULLï¼‰
3. åªæœ‰InnoDBå¼•æ“æ”¯æŒå¤–é”®
4. å¤–é”®ä¼šå½±å“æ€§èƒ½ï¼Œå¤§å‹ç³»ç»Ÿå¯è€ƒè™‘åœ¨åº”ç”¨å±‚ç»´æŠ¤å…³ç³»

---

## å››ã€å”¯ä¸€çº¦æŸ

### 4.1 å”¯ä¸€çº¦æŸçš„ç‰¹ç‚¹

- âœ… ä¿è¯å­—æ®µå€¼å”¯ä¸€
- âœ… å¯ä»¥ä¸ºNULLï¼ˆNULLä¸å‚ä¸å”¯ä¸€æ€§æ£€æŸ¥ï¼‰
- âœ… ä¸€å¼ è¡¨å¯ä»¥æœ‰å¤šä¸ªå”¯ä¸€çº¦æŸ
- âš¡ è‡ªåŠ¨åˆ›å»ºå”¯ä¸€ç´¢å¼•

### 4.2 åˆ›å»ºå”¯ä¸€çº¦æŸ

```sql
-- æ–¹å¼ä¸€ï¼šåˆ›å»ºè¡¨æ—¶å®šä¹‰
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL UNIQUE,      -- å”¯ä¸€çº¦æŸ
    email VARCHAR(100) UNIQUE,                 -- å”¯ä¸€çº¦æŸ
    phone VARCHAR(20),
    UNIQUE (phone)                             -- æˆ–åœ¨åé¢å®šä¹‰
);

-- è”åˆå”¯ä¸€çº¦æŸ
CREATE TABLE user_roles (
    user_id INT,
    role_id INT,
    UNIQUE (user_id, role_id)  -- ç»„åˆå¿…é¡»å”¯ä¸€
);

-- æ–¹å¼äºŒï¼šä¿®æ”¹è¡¨æ·»åŠ 
ALTER TABLE users ADD UNIQUE (email);

-- æŒ‡å®šçº¦æŸå
ALTER TABLE users 
ADD CONSTRAINT uk_email UNIQUE (email);
```

### 4.3 åˆ é™¤å”¯ä¸€çº¦æŸ

```sql
-- åˆ é™¤å”¯ä¸€çº¦æŸï¼ˆé€šè¿‡ç´¢å¼•åï¼‰
ALTER TABLE users DROP INDEX email;

-- åˆ é™¤å‘½åçš„çº¦æŸ
ALTER TABLE users DROP INDEX uk_email;
```

### 4.4 ä¸»é”® vs å”¯ä¸€çº¦æŸ

| ç‰¹æ€§ | ä¸»é”® PRIMARY KEY | å”¯ä¸€çº¦æŸ UNIQUE |
|------|-----------------|----------------|
| å”¯ä¸€æ€§ | âœ… | âœ… |
| å¯ä¸ºNULL | âŒ | âœ… |
| æ•°é‡é™åˆ¶ | ä¸€å¼ è¡¨åªèƒ½ä¸€ä¸ª | å¯ä»¥æœ‰å¤šä¸ª |
| è‡ªåŠ¨åˆ›å»ºç´¢å¼• | âœ… | âœ… |

---

## äº”ã€éç©ºçº¦æŸ

### 5.1 éç©ºçº¦æŸçš„ä½œç”¨

- âŒ ä¸å…è®¸å­—æ®µå€¼ä¸ºNULL
- âœ… ä¿è¯æ•°æ®å®Œæ•´æ€§

### 5.2 åˆ›å»ºéç©ºçº¦æŸ

```sql
-- åˆ›å»ºè¡¨æ—¶å®šä¹‰
CREATE TABLE employees (
    id INT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,        -- éç©º
    email VARCHAR(100) NOT NULL,      -- éç©º
    phone VARCHAR(20)                 -- å¯ä¸ºç©º
);

-- ä¿®æ”¹è¡¨æ·»åŠ éç©ºçº¦æŸ
ALTER TABLE employees MODIFY phone VARCHAR(20) NOT NULL;
```

### 5.3 åˆ é™¤éç©ºçº¦æŸ

```sql
-- ä¿®æ”¹å­—æ®µä¸ºå…è®¸NULL
ALTER TABLE employees MODIFY phone VARCHAR(20) NULL;
```

---

## å…­ã€é»˜è®¤çº¦æŸ

### 6.1 é»˜è®¤çº¦æŸçš„ä½œç”¨

å½“æ’å…¥æ•°æ®æ—¶æœªæŒ‡å®šå­—æ®µå€¼ï¼Œè‡ªåŠ¨ä½¿ç”¨é»˜è®¤å€¼ã€‚

### 6.2 åˆ›å»ºé»˜è®¤çº¦æŸ

```sql
-- åˆ›å»ºè¡¨æ—¶å®šä¹‰
CREATE TABLE articles (
    id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(200) NOT NULL,
    content TEXT,
    view_count INT DEFAULT 0,              -- é»˜è®¤ä¸º0
    status TINYINT DEFAULT 1,              -- é»˜è®¤ä¸º1
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,          -- é»˜è®¤å½“å‰æ—¶é—´
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP 
               ON UPDATE CURRENT_TIMESTAMP                   -- è‡ªåŠ¨æ›´æ–°
);

-- ä¿®æ”¹è¡¨æ·»åŠ é»˜è®¤å€¼
ALTER TABLE articles 
ALTER COLUMN status SET DEFAULT 1;
```

### 6.3 åˆ é™¤é»˜è®¤çº¦æŸ

```sql
ALTER TABLE articles 
ALTER COLUMN status DROP DEFAULT;
```

### 6.4 å¸¸ç”¨é»˜è®¤å€¼

```sql
-- æ•°å€¼é»˜è®¤å€¼
price DECIMAL(10,2) DEFAULT 0.00

-- å­—ç¬¦ä¸²é»˜è®¤å€¼
gender CHAR(1) DEFAULT 'ç”·'
status VARCHAR(20) DEFAULT 'active'

-- æ—¥æœŸæ—¶é—´é»˜è®¤å€¼
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP

-- å¸ƒå°”é»˜è®¤å€¼ï¼ˆTINYINTï¼‰
is_deleted TINYINT DEFAULT 0
```

---

## ä¸ƒã€æ£€æŸ¥çº¦æŸ

### 7.1 æ£€æŸ¥çº¦æŸçš„ä½œç”¨

æ£€æŸ¥çº¦æŸç”¨äºé™åˆ¶å­—æ®µå€¼å¿…é¡»æ»¡è¶³æŒ‡å®šæ¡ä»¶ï¼ˆMySQL 8.0.16+æ”¯æŒï¼‰ã€‚

### 7.2 åˆ›å»ºæ£€æŸ¥çº¦æŸ

```sql
-- åˆ›å»ºè¡¨æ—¶å®šä¹‰
CREATE TABLE employees (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    age INT CHECK (age >= 18 AND age <= 65),              -- å¹´é¾„èŒƒå›´
    salary DECIMAL(10,2) CHECK (salary > 0),              -- è–ªèµ„å¤§äº0
    gender CHAR(1) CHECK (gender IN ('ç”·', 'å¥³')),        -- æ€§åˆ«é™åˆ¶
    email VARCHAR(100),
    CONSTRAINT chk_email CHECK (email LIKE '%@%.%')       -- é‚®ç®±æ ¼å¼
);

-- ä¿®æ”¹è¡¨æ·»åŠ æ£€æŸ¥çº¦æŸ
ALTER TABLE employees 
ADD CONSTRAINT chk_age CHECK (age BETWEEN 18 AND 65);
```

### 7.3 åˆ é™¤æ£€æŸ¥çº¦æŸ

```sql
ALTER TABLE employees DROP CHECK chk_age;
```

### 7.4 å¸¸ç”¨æ£€æŸ¥çº¦æŸç¤ºä¾‹

```sql
-- èŒƒå›´æ£€æŸ¥
age INT CHECK (age >= 0 AND age <= 150)
score DECIMAL(5,2) CHECK (score >= 0 AND score <= 100)

-- æšä¸¾æ£€æŸ¥
status VARCHAR(20) CHECK (status IN ('active', 'inactive', 'banned'))
level TINYINT CHECK (level IN (1, 2, 3, 4, 5))

-- æ ¼å¼æ£€æŸ¥
phone VARCHAR(20) CHECK (phone REGEXP '^1[3-9][0-9]{9}$')
email VARCHAR(100) CHECK (email LIKE '%@%.%')

-- é€»è¾‘æ£€æŸ¥
start_date DATE,
end_date DATE,
CHECK (end_date > start_date)
```

---

## å…«ã€ç»¼åˆåº”ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šå®Œæ•´çš„ç”¨æˆ·è¡¨

```sql
CREATE TABLE users (
    -- ä¸»é”®çº¦æŸ + è‡ªå¢
    user_id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç”¨æˆ·ID',
    
    -- éç©º + å”¯ä¸€çº¦æŸ
    username VARCHAR(50) NOT NULL UNIQUE COMMENT 'ç”¨æˆ·å',
    
    -- éç©ºçº¦æŸ
    password VARCHAR(100) NOT NULL COMMENT 'å¯†ç ',
    
    -- å”¯ä¸€çº¦æŸ + æ£€æŸ¥çº¦æŸ
    email VARCHAR(100) UNIQUE 
        CHECK (email LIKE '%@%.%') COMMENT 'é‚®ç®±',
    
    -- å”¯ä¸€çº¦æŸ + æ£€æŸ¥çº¦æŸ
    phone VARCHAR(20) UNIQUE 
        CHECK (phone REGEXP '^1[3-9][0-9]{9}$') COMMENT 'æ‰‹æœºå·',
    
    -- æ£€æŸ¥çº¦æŸ
    age INT CHECK (age >= 18 AND age <= 120) COMMENT 'å¹´é¾„',
    
    -- æ£€æŸ¥çº¦æŸï¼ˆæšä¸¾ï¼‰
    gender CHAR(1) DEFAULT 'ç”·' 
        CHECK (gender IN ('ç”·', 'å¥³')) COMMENT 'æ€§åˆ«',
    
    -- é»˜è®¤çº¦æŸ
    status TINYINT DEFAULT 1 
        CHECK (status IN (0, 1)) COMMENT 'çŠ¶æ€ï¼š0-ç¦ç”¨ï¼Œ1-å¯ç”¨',
    
    -- é»˜è®¤çº¦æŸï¼ˆæ—¶é—´æˆ³ï¼‰
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP 
               ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´'
) COMMENT 'ç”¨æˆ·è¡¨';
```

### æ¡ˆä¾‹2ï¼šè®¢å•å’Œè®¢å•è¯¦æƒ…ï¼ˆå¤–é”®ï¼‰

```sql
-- è®¢å•è¡¨
CREATE TABLE orders (
    order_id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    order_no VARCHAR(50) NOT NULL UNIQUE,
    total_amount DECIMAL(10,2) NOT NULL CHECK (total_amount >= 0),
    status TINYINT DEFAULT 1 CHECK (status IN (1,2,3,4,5)),
    order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(user_id) 
        ON DELETE RESTRICT 
        ON UPDATE CASCADE
) COMMENT 'è®¢å•è¡¨';

-- è®¢å•è¯¦æƒ…è¡¨
CREATE TABLE order_items (
    item_id INT PRIMARY KEY AUTO_INCREMENT,
    order_id INT NOT NULL,
    product_id INT NOT NULL,
    quantity INT NOT NULL CHECK (quantity > 0),
    price DECIMAL(10,2) NOT NULL CHECK (price >= 0),
    subtotal DECIMAL(10,2) NOT NULL CHECK (subtotal >= 0),
    FOREIGN KEY (order_id) REFERENCES orders(order_id) 
        ON DELETE CASCADE 
        ON UPDATE CASCADE
) COMMENT 'è®¢å•è¯¦æƒ…è¡¨';
```

### æ¡ˆä¾‹3ï¼šå­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿ

```sql
-- å­¦ç”Ÿè¡¨
CREATE TABLE students (
    student_id INT PRIMARY KEY AUTO_INCREMENT,
    student_no VARCHAR(20) NOT NULL UNIQUE,
    name VARCHAR(50) NOT NULL,
    gender CHAR(1) CHECK (gender IN ('ç”·', 'å¥³')),
    birth_date DATE,
    major VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- è¯¾ç¨‹è¡¨
CREATE TABLE courses (
    course_id INT PRIMARY KEY AUTO_INCREMENT,
    course_no VARCHAR(20) NOT NULL UNIQUE,
    course_name VARCHAR(100) NOT NULL,
    credits DECIMAL(3,1) CHECK (credits > 0),
    max_students INT CHECK (max_students > 0)
);

-- é€‰è¯¾è¡¨ï¼ˆè”åˆä¸»é”® + å¤–é”®ï¼‰
CREATE TABLE enrollments (
    student_id INT,
    course_id INT,
    score DECIMAL(5,2) CHECK (score >= 0 AND score <= 100),
    enroll_date DATE NOT NULL,
    PRIMARY KEY (student_id, course_id),
    FOREIGN KEY (student_id) REFERENCES students(student_id) 
        ON DELETE CASCADE,
    FOREIGN KEY (course_id) REFERENCES courses(course_id) 
        ON DELETE CASCADE
);
```

---

## ä¹ã€æœ¬ç« æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. **ä¸»é”®çº¦æŸ**ï¼šå”¯ä¸€æ ‡è¯†ï¼Œéç©ºä¸”å”¯ä¸€ï¼Œä¸€è¡¨ä¸€ä¸ª
2. **å¤–é”®çº¦æŸ**ï¼šç»´æŠ¤è¡¨é—´å…³ç³»ï¼Œä¿è¯å¼•ç”¨å®Œæ•´æ€§
3. **å”¯ä¸€çº¦æŸ**ï¼šä¿è¯æ•°æ®å”¯ä¸€ï¼Œå¯ä»¥ä¸ºNULL
4. **éç©ºçº¦æŸ**ï¼šå­—æ®µå€¼ä¸èƒ½ä¸ºNULL
5. **é»˜è®¤çº¦æŸ**ï¼šæœªæŒ‡å®šå€¼æ—¶ä½¿ç”¨é»˜è®¤å€¼
6. **æ£€æŸ¥çº¦æŸ**ï¼šé™åˆ¶å­—æ®µå€¼æ»¡è¶³æ¡ä»¶

### çº¦æŸä½¿ç”¨å»ºè®®

- âœ… åˆç†ä½¿ç”¨çº¦æŸä¿è¯æ•°æ®è´¨é‡
- âœ… ä¸»é”®å°½é‡ä½¿ç”¨è‡ªå¢æ•´æ•°
- âœ… å¤–é”®è°¨æ…ä½¿ç”¨ï¼Œæ³¨æ„æ€§èƒ½å½±å“
- âœ… å”¯ä¸€çº¦æŸç”¨äºä¿è¯ä¸šåŠ¡å”¯ä¸€æ€§
- âœ… é‡è¦å­—æ®µæ·»åŠ éç©ºçº¦æŸ
- âœ… æ£€æŸ¥çº¦æŸå‡è½»åº”ç”¨å±‚è´Ÿæ‹…

---

## ç»ƒä¹ é¢˜

```sql
-- 1. åˆ›å»ºå‘˜å·¥è¡¨ï¼ŒåŒ…å«å„ç§çº¦æŸ
CREATE TABLE employees (
    emp_id INT PRIMARY KEY AUTO_INCREMENT,
    emp_no VARCHAR(20) NOT NULL UNIQUE,
    name VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE CHECK (email LIKE '%@%.%'),
    age INT CHECK (age >= 18 AND age <= 65),
    salary DECIMAL(10,2) CHECK (salary > 0),
    dept_id INT,
    status TINYINT DEFAULT 1 CHECK (status IN (0, 1)),
    FOREIGN KEY (dept_id) REFERENCES departments(dept_id)
);

-- 2. æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO employees (emp_no, name, email, age, salary, dept_id) 
VALUES ('E001', 'å¼ ä¸‰', 'zhangsan@example.com', 28, 8000, 1);

-- 3. å°è¯•æ’å…¥è¿åçº¦æŸçš„æ•°æ®ï¼ˆä¼šå¤±è´¥ï¼‰
INSERT INTO employees (emp_no, name, age) 
VALUES ('E001', 'æå››', 17);  -- è¿åå”¯ä¸€çº¦æŸå’Œå¹´é¾„æ£€æŸ¥
```

---

**ä¸Šä¸€ç« ï¼š** [å‡½æ•°è¯¦è§£](/tutorials/java-backend/mysql/ç¬¬02ç« -è¿›é˜¶ç¯‡/01-å‡½æ•°è¯¦è§£/)

**ä¸‹ä¸€ç« ï¼š** [å¤šè¡¨æŸ¥è¯¢ä¸è¿æ¥](/tutorials/java-backend/mysql/ç¬¬02ç« -è¿›é˜¶ç¯‡/03-å¤šè¡¨æŸ¥è¯¢ä¸è¿æ¥/) â†’
