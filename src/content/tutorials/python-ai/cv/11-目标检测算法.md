---
title: ç›®æ ‡æ£€æµ‹ç®—æ³•
prevChapter: "python-ai/cv/10-è¿ç§»å­¦ä¹ "
nextChapter: "python-ai/cv/12-å®æˆ˜æ¡ˆä¾‹"
parentChapter: "python-ai/cv/README"
---
# ç›®æ ‡æ£€æµ‹ç®—æ³•

> æŒæ¡æ·±åº¦å­¦ä¹ ç›®æ ‡æ£€æµ‹ç®—æ³•

## ğŸ“š å­¦ä¹ ç›®æ ‡

- ç†è§£YOLOç®—æ³•
- å­¦ä¼šä½¿ç”¨YOLOv5
- äº†è§£å…¶ä»–æ£€æµ‹ç®—æ³•
- æŒæ¡æ¨¡å‹éƒ¨ç½²

## 1. YOLOv5 ä½¿ç”¨

```python
import torch

# åŠ è½½æ¨¡å‹
model = torch.hub.load('ultralytics/yolov5', 'yolov5s', pretrained=True)

# æ¨ç†
img = 'image.jpg'
results = model(img)

# æ˜¾ç¤ºç»“æœ
results.show()

# æ‰“å°ç»“æœ
results.print()

# ä¿å­˜ç»“æœ
results.save()
```

## 2. å®æ—¶æ£€æµ‹

```python
import cv2

# åŠ è½½æ¨¡å‹
model = torch.hub.load('ultralytics/yolov5', 'yolov5s')

# æ‰“å¼€æ‘„åƒå¤´
cap = cv2.VideoCapture(0)

while True:
    ret, frame = cap.read()
    if not ret:
        break
    
    # æ£€æµ‹
    results = model(frame)
    
    # æ¸²æŸ“ç»“æœ
    rendered = results.render()[0]
    
    # æ˜¾ç¤º
    cv2.imshow('YOLOv5', rendered)
    
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

cap.release()
cv2.destroyAllWindows()
```

## 3. è‡ªå®šä¹‰è®­ç»ƒ

```python
# å‡†å¤‡æ•°æ®é›†ï¼ˆYOLOæ ¼å¼ï¼‰
# data.yaml é…ç½®æ–‡ä»¶

# è®­ç»ƒ
!python train.py --img 640 --batch 16 --epochs 50 \
                 --data data.yaml --weights yolov5s.pt

# éªŒè¯
!python val.py --weights runs/train/exp/weights/best.pt \
               --data data.yaml

# æ¨ç†
!python detect.py --weights runs/train/exp/weights/best.pt \
                  --source test.jpg
```

## 4. å…¶ä»–ç®—æ³•

```python
# Faster R-CNN
import torchvision
model = torchvision.models.detection.fasterrcnn_resnet50_fpn(pretrained=True)

# RetinaNet
model = torchvision.models.detection.retinanet_resnet50_fpn(pretrained=True)

# ä½¿ç”¨
model.eval()
with torch.no_grad():
    predictions = model(images)
```

---

**ä¸‹ä¸€èŠ‚ï¼š** [å®æˆ˜æ¡ˆä¾‹](12-å®æˆ˜æ¡ˆä¾‹.md)
