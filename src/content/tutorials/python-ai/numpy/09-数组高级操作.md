---
title: æ•°ç»„é«˜çº§æ“ä½œ
prevChapter: "python-ai/numpy/08-ç»Ÿè®¡å‡½æ•°"
nextChapter: "python-ai/numpy/10-å®æˆ˜æ¡ˆä¾‹"
parentChapter: "python-ai/numpy/README"
---
# æ•°ç»„é«˜çº§æ“ä½œ

> æŒæ¡NumPyçš„é«˜çº§æ•°ç»„æ“ä½œæŠ€å·§

## ğŸ“š å­¦ä¹ ç›®æ ‡

- æŒæ¡æ•°ç»„æ’åº
- å­¦ä¼šæ•°æ®å»é‡
- æŒæ¡æ¡ä»¶ç­›é€‰
- ç†è§£é›†åˆè¿ç®—

## 1. æ•°ç»„æ’åº

```python
import numpy as np

arr = np.array([3, 1, 4, 1, 5, 9, 2, 6])

# sort - è¿”å›æ’åºåçš„å‰¯æœ¬
sorted_arr = np.sort(arr)
print('æ’åºå:', sorted_arr)
print('åŸæ•°ç»„:', arr)  # ä¸å˜

# argsort - è¿”å›æ’åºåçš„ç´¢å¼•
indices = np.argsort(arr)
print('æ’åºç´¢å¼•:', indices)
print('ä½¿ç”¨ç´¢å¼•æ’åº:', arr[indices])

# é™åºæ’åº
desc_sorted = np.sort(arr)[::-1]
print('é™åº:', desc_sorted)

# å¤šç»´æ’åº
arr_2d = np.array([[3, 1, 4], [2, 9, 5]])
print('æŒ‰è¡Œæ’åº:\n', np.sort(arr_2d, axis=1))
print('æŒ‰åˆ—æ’åº:\n', np.sort(arr_2d, axis=0))
```

## 2. éƒ¨åˆ†æ’åº

```python
arr = np.array([3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5])

# partition - éƒ¨åˆ†æ’åºï¼ˆç¬¬kå°çš„å…ƒç´ ï¼‰
k = 5
partitioned = np.partition(arr, k)
print(f'ç¬¬{k}å°çš„å…ƒç´ : {partitioned[k]}')
print('éƒ¨åˆ†æ’åº:', partitioned)

# argpartition
indices = np.argpartition(arr, k)
print('éƒ¨åˆ†æ’åºç´¢å¼•:', indices)
```

## 3. æœç´¢å’ŒæŸ¥æ‰¾

```python
arr = np.array([1, 2, 3, 4, 5])

# searchsorted - äºŒåˆ†æŸ¥æ‰¾æ’å…¥ä½ç½®
pos = np.searchsorted(arr, 3.5)
print(f'3.5åº”æ’å…¥ä½ç½®: {pos}')

# where - æ¡ä»¶ç´¢å¼•
arr = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9])
indices = np.where(arr > 5)
print('å¤§äº5çš„ç´¢å¼•:', indices[0])
print('å¤§äº5çš„å…ƒç´ :', arr[indices])

# æ¡ä»¶æ›¿æ¢
result = np.where(arr > 5, arr, 0)
print('æ›¿æ¢å:', result)  # [0 0 0 0 0 6 7 8 9]

# å¤šæ¡ä»¶
result = np.where((arr > 3) & (arr < 7), arr, 0)
print('3åˆ°7ä¹‹é—´:', result)
```

## 4. å”¯ä¸€å€¼å’Œå»é‡

```python
arr = np.array([1, 2, 2, 3, 3, 3, 4, 4, 4, 4])

# å»é‡
unique_vals = np.unique(arr)
print('å”¯ä¸€å€¼:', unique_vals)

# è¿”å›ç´¢å¼•
unique_vals, indices = np.unique(arr, return_index=True)
print('é¦–æ¬¡å‡ºç°ç´¢å¼•:', indices)

# è¿”å›é€†ç´¢å¼•
unique_vals, inverse = np.unique(arr, return_inverse=True)
print('é€†ç´¢å¼•:', inverse)
print('é‡æ„:', unique_vals[inverse])

# è¿”å›è®¡æ•°
unique_vals, counts = np.unique(arr, return_counts=True)
print('å”¯ä¸€å€¼:', unique_vals)
print('å‡ºç°æ¬¡æ•°:', counts)
```

## 5. é›†åˆè¿ç®—

```python
a = np.array([1, 2, 3, 4, 5])
b = np.array([3, 4, 5, 6, 7])

# äº¤é›†
intersection = np.intersect1d(a, b)
print('äº¤é›†:', intersection)  # [3 4 5]

# å¹¶é›†
union = np.union1d(a, b)
print('å¹¶é›†:', union)  # [1 2 3 4 5 6 7]

# å·®é›†ï¼ˆaä¸­æœ‰bä¸­æ²¡æœ‰ï¼‰
diff = np.setdiff1d(a, b)
print('å·®é›†:', diff)  # [1 2]

# å¯¹ç§°å·®é›†
sym_diff = np.setxor1d(a, b)
print('å¯¹ç§°å·®é›†:', sym_diff)  # [1 2 6 7]

# åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­
is_in = np.in1d(a, b)
print('æ˜¯å¦åœ¨bä¸­:', is_in)
```

## 6. æ¡ä»¶å‡½æ•°

```python
arr = np.array([1, 2, 3, 4, 5])

# all - æ‰€æœ‰å…ƒç´ æ»¡è¶³æ¡ä»¶
print('å…¨éƒ¨>0:', np.all(arr > 0))  # True
print('å…¨éƒ¨>3:', np.all(arr > 3))  # False

# any - ä»»ä¸€å…ƒç´ æ»¡è¶³æ¡ä»¶
print('ä»»ä¸€>3:', np.any(arr > 3))  # True

# å¤šç»´æ•°ç»„
arr_2d = np.array([[1, 2, 3], [4, 5, 6]])
print('æ¯è¡Œå…¨éƒ¨>0:', np.all(arr_2d > 0, axis=1))
print('æ¯åˆ—ä»»ä¸€>3:', np.any(arr_2d > 3, axis=0))
```

## 7. æ•°ç»„æ¯”è¾ƒ

```python
a = np.array([1, 2, 3])
b = np.array([1, 2, 4])

# array_equal - æ•°ç»„æ˜¯å¦å®Œå…¨ç›¸ç­‰
print('å®Œå…¨ç›¸ç­‰:', np.array_equal(a, b))  # False

# allclose - æµ®ç‚¹æ•°è¿‘ä¼¼ç›¸ç­‰
a_float = np.array([1.0, 2.0, 3.0])
b_float = np.array([1.0, 2.0, 3.000001])
print('è¿‘ä¼¼ç›¸ç­‰:', np.allclose(a_float, b_float))  # True

# isclose - é€å…ƒç´ æ¯”è¾ƒ
print('é€å…ƒç´ è¿‘ä¼¼:', np.isclose(a_float, b_float))
```

## 8. æ•°æ®ç­›é€‰æŠ€å·§

```python
data = np.array([85, 92, 78, 95, 88, 76, 90, 82, 94, 87])

# è·å–å‰3å
top3_indices = np.argsort(data)[-3:][::-1]
top3_scores = data[top3_indices]
print('å‰3ååˆ†æ•°:', top3_scores)

# ç­›é€‰ä¼˜ç§€æˆç»©
excellent = data[data >= 90]
print('ä¼˜ç§€æˆç»©:', excellent)

# æ›¿æ¢ä¸åŠæ ¼æˆç»©
data_copy = data.copy()
data_copy[data_copy < 60] = 60
print('æ›¿æ¢å:', data_copy)

# åˆ†ç»„ç»Ÿè®¡
bins = [0, 60, 80, 90, 100]
labels = ['ä¸åŠæ ¼', 'åŠæ ¼', 'è‰¯å¥½', 'ä¼˜ç§€']
groups = np.digitize(data, bins)
for i, label in enumerate(labels, 1):
    count = np.sum(groups == i)
    print(f'{label}: {count}äºº')
```

## 9. å®æˆ˜ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæ•°æ®æ¸…æ´—

```python
# å«æœ‰å¼‚å¸¸å€¼çš„æ•°æ®
data = np.array([1, 2, 3, 100, 4, 5, -50, 6, 7, 8])

# ä½¿ç”¨å››åˆ†ä½æ•°æ³•æ£€æµ‹å¼‚å¸¸å€¼
q1 = np.percentile(data, 25)
q3 = np.percentile(data, 75)
iqr = q3 - q1
lower_bound = q1 - 1.5 * iqr
upper_bound = q3 + 1.5 * iqr

# ç§»é™¤å¼‚å¸¸å€¼
clean_data = data[(data >= lower_bound) & (data <= upper_bound)]
print('æ¸…æ´—å:', clean_data)
```

### ç¤ºä¾‹2ï¼šTop-Kç®—æ³•

```python
def top_k(arr, k):
    """è·å–å‰kå¤§çš„å…ƒç´ ï¼ˆä¸å®Œå…¨æ’åºï¼‰"""
    indices = np.argpartition(arr, -k)[-k:]
    top_k_indices = indices[np.argsort(arr[indices])[::-1]]
    return arr[top_k_indices]

data = np.random.randint(1, 100, 20)
print('å‰5å¤§:', top_k(data, 5))
```

## 10. æ€§èƒ½ä¼˜åŒ–æŠ€å·§

```python
import time

arr = np.random.rand(1000000)

# ä½¿ç”¨å¸ƒå°”ç´¢å¼•ï¼ˆå¿«ï¼‰
start = time.time()
result = arr[arr > 0.5]
print(f'å¸ƒå°”ç´¢å¼•: {time.time() - start:.6f}ç§’')

# ä½¿ç”¨whereï¼ˆè¾ƒæ…¢ï¼‰
start = time.time()
indices = np.where(arr > 0.5)[0]
result = arr[indices]
print(f'whereç´¢å¼•: {time.time() - start:.6f}ç§’')
```

## ç»ƒä¹ é¢˜

1. æ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„å…ƒç´ 
2. å®ç°æ•°ç»„çš„å»é‡å¹¶ä¿æŒåŸé¡ºåº
3. æ‰¾å‡ºä¸¤ä¸ªæ•°ç»„çš„å…¬å…±å…ƒç´ å’Œå”¯ä¸€å…ƒç´ 
4. ä½¿ç”¨partitionæ‰¾åˆ°ä¸­ä½æ•°

---

**ä¸‹ä¸€èŠ‚ï¼š** [å®æˆ˜æ¡ˆä¾‹](10-å®æˆ˜æ¡ˆä¾‹.md)
