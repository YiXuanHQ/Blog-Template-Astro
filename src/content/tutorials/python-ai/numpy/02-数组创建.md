---
title: æ•°ç»„åˆ›å»º
prevChapter: "python-ai/numpy/01-NumPyå…¥é—¨"
nextChapter: "python-ai/numpy/03-æ•°ç»„ç´¢å¼•ä¸åˆ‡ç‰‡"
parentChapter: "python-ai/numpy/README"
---
# æ•°ç»„åˆ›å»º

> æŒæ¡å¤šç§åˆ›å»ºNumPyæ•°ç»„çš„æ–¹æ³•

## ğŸ“š å­¦ä¹ ç›®æ ‡

- æŒæ¡ä»Pythonå¯¹è±¡åˆ›å»ºæ•°ç»„
- å­¦ä¼šä½¿ç”¨å†…ç½®å‡½æ•°åˆ›å»ºæ•°ç»„
- æŒæ¡åˆ›å»ºç‰¹æ®Šæ•°ç»„çš„æ–¹æ³•
- å­¦ä¼šç”Ÿæˆéšæœºæ•°ç»„

## 1. ä»Pythonå¯¹è±¡åˆ›å»º

### 1.1 ä»åˆ—è¡¨åˆ›å»º

```python
import numpy as np

# ä¸€ç»´æ•°ç»„
arr_1d = np.array([1, 2, 3, 4, 5])
print(arr_1d)  # [1 2 3 4 5]

# äºŒç»´æ•°ç»„
arr_2d = np.array([[1, 2, 3], [4, 5, 6]])
print(arr_2d)
# [[1 2 3]
#  [4 5 6]]

# ä¸‰ç»´æ•°ç»„
arr_3d = np.array([[[1, 2], [3, 4]], [[5, 6], [7, 8]]])
print(arr_3d.shape)  # (2, 2, 2)
```

### 1.2 ä»å…ƒç»„åˆ›å»º

```python
# å…ƒç»„ä¹Ÿå¯ä»¥åˆ›å»ºæ•°ç»„
arr = np.array((1, 2, 3, 4, 5))
print(arr)  # [1 2 3 4 5]

# åµŒå¥—å…ƒç»„
arr_2d = np.array(((1, 2, 3), (4, 5, 6)))
print(arr_2d)
```

### 1.3 æŒ‡å®šæ•°æ®ç±»å‹

```python
# åˆ›å»ºæµ®ç‚¹æ•°æ•°ç»„
arr_float = np.array([1, 2, 3], dtype=float)
print(arr_float)  # [1. 2. 3.]

# åˆ›å»ºå¤æ•°æ•°ç»„
arr_complex = np.array([1, 2, 3], dtype=complex)
print(arr_complex)  # [1.+0.j 2.+0.j 3.+0.j]

# åˆ›å»ºå­—ç¬¦ä¸²æ•°ç»„
arr_str = np.array([1, 2, 3], dtype=str)
print(arr_str)  # ['1' '2' '3']
```

## 2. ä½¿ç”¨å†…ç½®å‡½æ•°åˆ›å»º

### 2.1 zeros - å…¨é›¶æ•°ç»„

```python
# ä¸€ç»´å…¨é›¶æ•°ç»„
zeros_1d = np.zeros(5)
print(zeros_1d)  # [0. 0. 0. 0. 0.]

# äºŒç»´å…¨é›¶æ•°ç»„
zeros_2d = np.zeros((3, 4))
print(zeros_2d)

# æŒ‡å®šæ•°æ®ç±»å‹
zeros_int = np.zeros((2, 3), dtype=int)
print(zeros_int)
```

### 2.2 ones - å…¨ä¸€æ•°ç»„

```python
# ä¸€ç»´å…¨ä¸€æ•°ç»„
ones_1d = np.ones(5)
print(ones_1d)  # [1. 1. 1. 1. 1.]

# äºŒç»´å…¨ä¸€æ•°ç»„
ones_2d = np.ones((2, 3))
print(ones_2d)

# æŒ‡å®šæ•°æ®ç±»å‹
ones_int = np.ones((3, 3), dtype=int)
print(ones_int)
```

### 2.3 full - æŒ‡å®šå€¼æ•°ç»„

```python
# åˆ›å»ºæ‰€æœ‰å…ƒç´ ä¸ºæŒ‡å®šå€¼çš„æ•°ç»„
full_arr = np.full((3, 3), 7)
print(full_arr)
# [[7 7 7]
#  [7 7 7]
#  [7 7 7]]

# ä½¿ç”¨æµ®ç‚¹æ•°
full_float = np.full((2, 4), 3.14)
print(full_float)
```

### 2.4 empty - ç©ºæ•°ç»„

```python
# åˆ›å»ºæœªåˆå§‹åŒ–çš„æ•°ç»„ï¼ˆå€¼æ˜¯éšæœºçš„ï¼‰
empty_arr = np.empty((2, 3))
print(empty_arr)  # éšæœºå€¼

# æ³¨æ„ï¼šempty ä¸ä¼šåˆå§‹åŒ–ä¸º0ï¼Œé€Ÿåº¦å¿«ä½†å€¼ä¸ç¡®å®š
```

### 2.5 eye / identity - å•ä½çŸ©é˜µ

```python
# å•ä½çŸ©é˜µ
identity_3x3 = np.eye(3)
print(identity_3x3)
# [[1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]]

# æŒ‡å®šå¯¹è§’çº¿åç§»
eye_offset = np.eye(4, k=1)
print(eye_offset)

# identity å‡½æ•°
identity_mat = np.identity(3)
print(identity_mat)
```

## 3. ç­‰å·®æ•°ç»„

### 3.1 arange - ç±»ä¼¼ range

```python
# åŸºæœ¬ç”¨æ³•
arr = np.arange(10)
print(arr)  # [0 1 2 3 4 5 6 7 8 9]

# æŒ‡å®šèµ·å§‹å’Œç»“æŸ
arr = np.arange(5, 15)
print(arr)  # [ 5  6  7  8  9 10 11 12 13 14]

# æŒ‡å®šæ­¥é•¿
arr = np.arange(0, 10, 2)
print(arr)  # [0 2 4 6 8]

# æµ®ç‚¹æ•°æ­¥é•¿
arr = np.arange(0, 1, 0.1)
print(arr)  # [0.  0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9]

# é€’å‡åºåˆ—
arr = np.arange(10, 0, -1)
print(arr)  # [10  9  8  7  6  5  4  3  2  1]
```

### 3.2 linspace - çº¿æ€§ç©ºé—´

```python
# åœ¨0åˆ°10ä¹‹é—´ç”Ÿæˆ5ä¸ªç­‰é—´è·çš„æ•°
arr = np.linspace(0, 10, 5)
print(arr)  # [ 0.   2.5  5.   7.5 10. ]

# åœ¨0åˆ°1ä¹‹é—´ç”Ÿæˆ11ä¸ªç‚¹
arr = np.linspace(0, 1, 11)
print(arr)  # [0.  0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1. ]

# ä¸åŒ…å«ç»“æŸç‚¹
arr = np.linspace(0, 10, 5, endpoint=False)
print(arr)  # [0. 2. 4. 6. 8.]

# è¿”å›æ­¥é•¿
arr, step = np.linspace(0, 10, 5, retstep=True)
print(f'æ•°ç»„: {arr}')
print(f'æ­¥é•¿: {step}')
```

### 3.3 logspace - å¯¹æ•°ç©ºé—´

```python
# 10^0 åˆ° 10^3ï¼Œç”Ÿæˆ4ä¸ªæ•°
arr = np.logspace(0, 3, 4)
print(arr)  # [   1.   10.  100. 1000.]

# 10^-1 åˆ° 10^1ï¼Œç”Ÿæˆ5ä¸ªæ•°
arr = np.logspace(-1, 1, 5)
print(arr)  # [ 0.1   0.31622777  1.  3.16227766 10. ]

# ä»¥2ä¸ºåº•
arr = np.logspace(0, 10, 11, base=2)
print(arr)  # [1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024]
```

## 4. éšæœºæ•°ç»„

### 4.1 åŸºæœ¬éšæœºå‡½æ•°

```python
# 0åˆ°1ä¹‹é—´çš„éšæœºæ•°
rand_arr = np.random.rand(3, 4)
print(rand_arr)

# æ ‡å‡†æ­£æ€åˆ†å¸ƒ
randn_arr = np.random.randn(3, 3)
print(randn_arr)

# æŒ‡å®šèŒƒå›´çš„éšæœºæ•´æ•°
randint_arr = np.random.randint(0, 10, size=(3, 3))
print(randint_arr)

# 0åˆ°1ä¹‹é—´çš„éšæœºæ•°ï¼ˆå¦ä¸€ç§æ–¹å¼ï¼‰
random_arr = np.random.random((2, 3))
print(random_arr)
```

### 4.2 ä¸åŒåˆ†å¸ƒçš„éšæœºæ•°

```python
# å‡åŒ€åˆ†å¸ƒ
uniform_arr = np.random.uniform(0, 10, size=(3, 3))
print('å‡åŒ€åˆ†å¸ƒ:', uniform_arr)

# æ­£æ€åˆ†å¸ƒï¼ˆæŒ‡å®šå‡å€¼å’Œæ ‡å‡†å·®ï¼‰
normal_arr = np.random.normal(loc=0, scale=1, size=(3, 3))
print('æ­£æ€åˆ†å¸ƒ:', normal_arr)

# æ³Šæ¾åˆ†å¸ƒ
poisson_arr = np.random.poisson(lam=3, size=(3, 3))
print('æ³Šæ¾åˆ†å¸ƒ:', poisson_arr)

# äºŒé¡¹åˆ†å¸ƒ
binomial_arr = np.random.binomial(n=10, p=0.5, size=(3, 3))
print('äºŒé¡¹åˆ†å¸ƒ:', binomial_arr)
```

### 4.3 è®¾ç½®éšæœºç§å­

```python
# è®¾ç½®éšæœºç§å­ä¿è¯ç»“æœå¯é‡å¤
np.random.seed(42)
arr1 = np.random.rand(3)
print(arr1)

np.random.seed(42)
arr2 = np.random.rand(3)
print(arr2)

# arr1 å’Œ arr2 å®Œå…¨ç›¸åŒ

# æ–°ç‰ˆæœ¬æ¨èä½¿ç”¨ Generator
rng = np.random.default_rng(42)
arr3 = rng.random(3)
print(arr3)
```

### 4.4 éšæœºæ‰“ä¹±å’Œé‡‡æ ·

```python
# æ‰“ä¹±æ•°ç»„
arr = np.arange(10)
np.random.shuffle(arr)
print('æ‰“ä¹±å:', arr)

# éšæœºé€‰æ‹©ï¼ˆä¸æ”¾å›ï¼‰
arr = np.arange(10)
sample = np.random.choice(arr, size=5, replace=False)
print('éšæœºé‡‡æ ·:', sample)

# éšæœºé€‰æ‹©ï¼ˆæ”¾å›ï¼‰
sample_with_replace = np.random.choice(arr, size=5, replace=True)
print('æ”¾å›é‡‡æ ·:', sample_with_replace)

# å¸¦æƒé‡çš„éšæœºé€‰æ‹©
elements = ['A', 'B', 'C', 'D']
probabilities = [0.1, 0.2, 0.3, 0.4]
sample = np.random.choice(elements, size=10, p=probabilities)
print('å¸¦æƒé‡é‡‡æ ·:', sample)
```

## 5. ä»å·²æœ‰æ•°ç»„åˆ›å»º

### 5.1 zeros_like / ones_like

```python
# åˆ›å»ºä¸ç»™å®šæ•°ç»„ç›¸åŒå½¢çŠ¶çš„æ•°ç»„
arr = np.array([[1, 2, 3], [4, 5, 6]])

zeros_like_arr = np.zeros_like(arr)
print(zeros_like_arr)

ones_like_arr = np.ones_like(arr)
print(ones_like_arr)

full_like_arr = np.full_like(arr, 10)
print(full_like_arr)
```

### 5.2 copy - å¤åˆ¶æ•°ç»„

```python
# åˆ›å»ºæ•°ç»„çš„å‰¯æœ¬
original = np.array([1, 2, 3, 4, 5])
copied = original.copy()

# ä¿®æ”¹å‰¯æœ¬ä¸å½±å“åŸæ•°ç»„
copied[0] = 100
print('åŸæ•°ç»„:', original)  # [1 2 3 4 5]
print('å‰¯æœ¬:', copied)      # [100 2 3 4 5]
```

## 6. ç‰¹æ®Šæ•°ç»„

### 6.1 å¯¹è§’çŸ©é˜µ

```python
# ä»ä¸€ç»´æ•°ç»„åˆ›å»ºå¯¹è§’çŸ©é˜µ
diag_arr = np.diag([1, 2, 3, 4])
print(diag_arr)
# [[1 0 0 0]
#  [0 2 0 0]
#  [0 0 3 0]
#  [0 0 0 4]]

# ä»äºŒç»´æ•°ç»„æå–å¯¹è§’çº¿
matrix = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
diagonal = np.diag(matrix)
print(diagonal)  # [1 5 9]
```

### 6.2 meshgrid - ç½‘æ ¼æ•°ç»„

```python
# åˆ›å»ºåæ ‡ç½‘æ ¼
x = np.array([1, 2, 3])
y = np.array([4, 5])

xx, yy = np.meshgrid(x, y)
print('Xç½‘æ ¼:\n', xx)
print('Yç½‘æ ¼:\n', yy)
# Xç½‘æ ¼:
# [[1 2 3]
#  [1 2 3]]
# Yç½‘æ ¼:
# [[4 4 4]
#  [5 5 5]]
```

## 7. å®æˆ˜ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šç”Ÿæˆæµ‹è¯•æ•°æ®

```python
# ç”Ÿæˆ100ä¸ª0åˆ°1ä¹‹é—´çš„éšæœºæ•°
data = np.random.rand(100)

# ç”Ÿæˆç¬¦åˆæ­£æ€åˆ†å¸ƒçš„æˆç»©æ•°æ®
scores = np.random.normal(loc=75, scale=10, size=1000)
scores = np.clip(scores, 0, 100)  # é™åˆ¶åœ¨0-100ä¹‹é—´

print(f'å¹³å‡åˆ†: {scores.mean():.2f}')
print(f'æ ‡å‡†å·®: {scores.std():.2f}')
```

### ç¤ºä¾‹2ï¼šåˆ›å»ºæ—¶é—´åºåˆ—

```python
# åˆ›å»ºæ—¥æœŸèŒƒå›´ï¼ˆé…åˆpandasä½¿ç”¨ï¼‰
dates = np.arange('2024-01', '2024-12', dtype='datetime64[M]')
print(dates)

# åˆ›å»ºç­‰é—´è·çš„æ—¶é—´ç‚¹
time_points = np.linspace(0, 10, 100)  # 0åˆ°10ç§’ï¼Œ100ä¸ªæ—¶é—´ç‚¹
values = np.sin(time_points)  # ç”Ÿæˆæ­£å¼¦æ³¢
```

### ç¤ºä¾‹3ï¼šåˆå§‹åŒ–ç¥ç»ç½‘ç»œæƒé‡

```python
# ä½¿ç”¨Heåˆå§‹åŒ–
def he_initialization(fan_in, fan_out):
    std = np.sqrt(2.0 / fan_in)
    weights = np.random.randn(fan_in, fan_out) * std
    return weights

# åˆ›å»ºç¥ç»ç½‘ç»œæƒé‡
weights = he_initialization(784, 128)
print(f'æƒé‡å½¢çŠ¶: {weights.shape}')
print(f'æƒé‡å‡å€¼: {weights.mean():.6f}')
print(f'æƒé‡æ ‡å‡†å·®: {weights.std():.6f}')
```

## 8. æ€§èƒ½å¯¹æ¯”

```python
import time

# æ¯”è¾ƒä¸åŒåˆ›å»ºæ–¹æ³•çš„æ€§èƒ½
size = (1000, 1000)

# zeros
start = time.time()
arr = np.zeros(size)
print(f'zeros: {time.time() - start:.6f}ç§’')

# empty
start = time.time()
arr = np.empty(size)
print(f'empty: {time.time() - start:.6f}ç§’')

# empty æ¯” zeros å¿«ï¼ˆä½†å€¼ä¸ç¡®å®šï¼‰
```

## 9. ç»ƒä¹ é¢˜

1. åˆ›å»ºä¸€ä¸ª5x5çš„å•ä½çŸ©é˜µ
2. åˆ›å»ºä¸€ä¸ªåŒ…å«0åˆ°100çš„å¶æ•°æ•°ç»„
3. ç”Ÿæˆ100ä¸ªå‡å€¼ä¸º50ï¼Œæ ‡å‡†å·®ä¸º10çš„éšæœºæ•°
4. åˆ›å»ºä¸€ä¸ª3x3çŸ©é˜µï¼Œå¯¹è§’çº¿ä¸º1ï¼Œ2ï¼Œ3ï¼Œå…¶ä½™ä¸º0
5. ç”Ÿæˆ10ä¸ª0åˆ°1ä¹‹é—´çš„éšæœºæ•°ï¼Œå¹¶å°†å®ƒä»¬æ’åº

## ğŸ’¡ é‡ç‚¹æ€»ç»“

- `np.array()` - ä»Pythonå¯¹è±¡åˆ›å»ºæ•°ç»„
- `np.zeros()` / `np.ones()` - åˆ›å»ºç‰¹æ®Šå€¼æ•°ç»„
- `np.arange()` / `np.linspace()` - åˆ›å»ºç­‰å·®æ•°ç»„
- `np.random` - ç”Ÿæˆéšæœºæ•°ç»„
- åˆç†é€‰æ‹©åˆ›å»ºæ–¹æ³•å¯ä»¥æé«˜æ€§èƒ½

---

**ä¸‹ä¸€èŠ‚ï¼š** [æ•°ç»„ç´¢å¼•ä¸åˆ‡ç‰‡](03-æ•°ç»„ç´¢å¼•ä¸åˆ‡ç‰‡.md)
