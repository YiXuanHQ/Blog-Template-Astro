---
title: å¤šç«¯ååŒå¼€å‘
date: 2025-01-22
prevChapter: "harmonyos-dev/10-distributed-next/03-åˆ†å¸ƒå¼ç»„ä»¶"
parentChapter: "harmonyos-dev/10-distributed-next/README"
---
# å¤šç«¯ååŒå¼€å‘

> æ„å»ºå¤šè®¾å¤‡ååŒåº”ç”¨

## ğŸ“± è®¾å¤‡ç±»å‹

### HarmonyOS NEXT æ”¯æŒçš„è®¾å¤‡

```typescript
// è®¾å¤‡ç±»å‹æšä¸¾
enum DeviceType {
  PHONE = 'phone',          // æ‰‹æœº
  TABLET = 'tablet',        // å¹³æ¿
  TWO_IN_ONE = '2in1',      // 2åˆ1è®¾å¤‡
  WEARABLE = 'wearable',    // ç©¿æˆ´è®¾å¤‡
  TV = 'tv',                // æ™ºæ…§å±
  CAR = 'car'               // è½¦æœº
}
```

## ğŸ–¥ï¸ æ‰‹æœº + å¹³æ¿ååŒ

### å“åº”å¼é€‚é…

```typescript
@Entry
@Component
struct ResponsiveLayout {
  @State currentBreakpoint: string = 'sm'
  
  aboutToAppear() {
    // ç›‘å¬æ–­ç‚¹å˜åŒ–
    this.currentBreakpoint = this.getBreakpoint()
  }
  
  getBreakpoint(): string {
    const width = display.getDefaultDisplaySync().width
    
    if (width < 600) {
      return 'sm'  // æ‰‹æœº
    } else if (width < 840) {
      return 'md'  // å°å¹³æ¿
    } else {
      return 'lg'  // å¤§å¹³æ¿
    }
  }
  
  build() {
    if (this.currentBreakpoint === 'sm') {
      // æ‰‹æœºå¸ƒå±€ - å•æ 
      this.phoneLayout()
    } else {
      // å¹³æ¿å¸ƒå±€ - åŒæ 
      this.tabletLayout()
    }
  }
  
  @Builder
  phoneLayout() {
    Column() {
      // å•æ å¸ƒå±€
      List() {
        ForEach([1, 2, 3, 4, 5], (item: number) => {
          ListItem() {
            Text(`Item ${item}`)
              .width('100%')
              .padding(20)
          }
        })
      }
    }
  }
  
  @Builder
  tabletLayout() {
    Row() {
      // å·¦ä¾§åˆ—è¡¨
      List() {
        ForEach([1, 2, 3, 4, 5], (item: number) => {
          ListItem() {
            Text(`Item ${item}`)
          }
        })
      }
      .width('40%')
      
      Divider().vertical(true)
      
      // å³ä¾§è¯¦æƒ…
      Column() {
        Text('è¯¦æƒ…åŒºåŸŸ')
          .fontSize(24)
      }
      .width('60%')
    }
  }
}
```

## ğŸ’» æ‰‹æœº + PC ååŒ

### è·¨è®¾å¤‡å‰ªè´´æ¿

```typescript
import { pasteboard } from '@kit.BasicServicesKit'

class CrossDeviceClipboard {
  // å¤åˆ¶åˆ°åˆ†å¸ƒå¼å‰ªè´´æ¿
  async copyToDistributed(text: string) {
    const pasteData = pasteboard.createData(pasteboard.MIMETYPE_TEXT_PLAIN, text)
    
    // è®¾ç½®ä¸ºåˆ†å¸ƒå¼å‰ªè´´æ¿
    const systemPasteboard = pasteboard.getSystemPasteboard()
    await systemPasteboard.setData(pasteData)
    
    // è®¾ç½®åˆ†å¸ƒå¼æ ‡å¿—
    await systemPasteboard.setShareOption(pasteboard.ShareOption.CrossDevice)
  }
  
  // ä»åˆ†å¸ƒå¼å‰ªè´´æ¿è¯»å–
  async pasteFromDistributed(): Promise<string> {
    const systemPasteboard = pasteboard.getSystemPasteboard()
    const pasteData = await systemPasteboard.getData()
    
    if (pasteData.hasMimeType(pasteboard.MIMETYPE_TEXT_PLAIN)) {
      return pasteData.getPrimaryText()
    }
    
    return ''
  }
}

// ä½¿ç”¨
@Entry
@Component
struct ClipboardDemo {
  @State copiedText: string = ''
  private clipboard: CrossDeviceClipboard = new CrossDeviceClipboard()
  
  build() {
    Column({ space: 20 }) {
      TextInput({ placeholder: 'è¾“å…¥æ–‡æœ¬' })
        .onChange((value) => {
          this.copiedText = value
        })
      
      Button('å¤åˆ¶åˆ°å…¶ä»–è®¾å¤‡')
        .onClick(async () => {
          await this.clipboard.copyToDistributed(this.copiedText)
          promptAction.showToast({ message: 'å·²å¤åˆ¶åˆ°åˆ†å¸ƒå¼å‰ªè´´æ¿' })
        })
      
      Button('ä»å…¶ä»–è®¾å¤‡ç²˜è´´')
        .onClick(async () => {
          const text = await this.clipboard.pasteFromDistributed()
          this.copiedText = text
          promptAction.showToast({ message: 'å·²ç²˜è´´' })
        })
    }
    .padding(20)
  }
}
```

## ğŸ¯ å®æˆ˜ï¼šå¤šå±ååŒç¬”è®°åº”ç”¨

```typescript
import { distributedDataObject } from '@kit.ArkData'
import { deviceManager } from '@kit.DistributedServiceKit'

@Entry
@Component
struct MultiScreenNotes {
  @State notes: Note[] = []
  @State selectedNote: Note | null = null
  @State deviceType: string = 'phone'
  @State connectedDevices: DeviceInfo[] = []
  
  private distributedObj: distributedDataObject.DataObject
  
  async aboutToAppear() {
    // æ£€æµ‹è®¾å¤‡ç±»å‹
    this.deviceType = this.getDeviceType()
    
    // åˆå§‹åŒ–åˆ†å¸ƒå¼æ•°æ®
    await this.initDistributedData()
    
    // è·å–è®¾å¤‡åˆ—è¡¨
    await this.getDeviceList()
  }
  
  getDeviceType(): string {
    const width = display.getDefaultDisplaySync().width
    return width < 600 ? 'phone' : 'tablet'
  }
  
  async initDistributedData() {
    this.distributedObj = distributedDataObject.create(getContext(this), {
      notes: [],
      selectedNoteId: ''
    })
    
    this.distributedObj.setSessionId('multiscreen_notes')
    
    this.distributedObj.on('change', (sessionId, fields) => {
      if (fields.includes('notes')) {
        this.notes = JSON.parse(JSON.stringify(this.distributedObj['notes']))
      }
      
      if (fields.includes('selectedNoteId')) {
        const id = this.distributedObj['selectedNoteId']
        this.selectedNote = this.notes.find(n => n.id === id) || null
      }
    })
  }
  
  async getDeviceList() {
    const dmInstance = deviceManager.createDeviceManager('com.example.notes')
    this.connectedDevices = dmInstance.getAvailableDeviceListSync()
  }
  
  selectNote(note: Note) {
    this.selectedNote = note
    // åŒæ­¥åˆ°å…¶ä»–è®¾å¤‡
    this.distributedObj['selectedNoteId'] = note.id
  }
  
  build() {
    if (this.deviceType === 'phone') {
      // æ‰‹æœºå¸ƒå±€ - ä½¿ç”¨Navigationç»„ä»¶
      Navigation() {
        this.buildNoteList()
      }
    } else {
      // å¹³æ¿/PCå¸ƒå±€ - å·¦å³åˆ†æ 
      Row() {
        // å·¦ä¾§ï¼šç¬”è®°åˆ—è¡¨
        Column() {
          this.buildNoteList()
        }
        .width('35%')
        .height('100%')
        .backgroundColor(0xF5F5F5)
        
        Divider().vertical(true)
        
        // å³ä¾§ï¼šç¬”è®°è¯¦æƒ…
        Column() {
          this.buildNoteDetail()
        }
        .width('65%')
        .height('100%')
      }
    }
  }
  
  @Builder
  buildNoteList() {
    Column() {
      // æ ‡é¢˜æ 
      Row({ space: 10 }) {
        Text('æˆ‘çš„ç¬”è®°')
          .fontSize(24)
          .fontWeight(FontWeight.Bold)
        
        Blank()
        
        Button('æ–°å»º')
          .onClick(() => {
            this.createNote()
          })
      }
      .width('100%')
      .padding(15)
      
      // è®¾å¤‡åˆ—è¡¨
      if (this.connectedDevices.length > 0) {
        Row({ space: 5 }) {
          Text('å·²è¿æ¥è®¾å¤‡:')
            .fontSize(12)
            .fontColor(Color.Gray)
          
          ForEach(this.connectedDevices, (device: DeviceInfo) => {
            Text(device.deviceName)
              .fontSize(12)
              .padding({ left: 5, right: 5 })
              .backgroundColor(0xE3F2FD)
              .borderRadius(4)
          })
        }
        .padding({ left: 15, right: 15, bottom: 10 })
      }
      
      // ç¬”è®°åˆ—è¡¨
      List({ space: 5 }) {
        ForEach(this.notes, (note: Note) => {
          ListItem() {
            Column({ space: 5 }) {
              Text(note.title)
                .fontSize(16)
                .fontWeight(FontWeight.Medium)
              
              Text(note.content)
                .fontSize(14)
                .maxLines(2)
                .fontColor(Color.Gray)
            }
            .width('100%')
            .padding(15)
            .backgroundColor(this.selectedNote?.id === note.id ? 0xE3F2FD : Color.White)
            .borderRadius(8)
            .onClick(() => {
              this.selectNote(note)
              
              // æ‰‹æœºç«¯è·³è½¬åˆ°è¯¦æƒ…é¡µ
              if (this.deviceType === 'phone') {
                // router.pushUrl({ url: 'pages/NoteDetail' })
              }
            })
          }
        })
      }
      .layoutWeight(1)
      .padding({ left: 15, right: 15 })
    }
  }
  
  @Builder
  buildNoteDetail() {
    if (this.selectedNote) {
      Column({ space: 20 }) {
        Text(this.selectedNote.title)
          .fontSize(28)
          .fontWeight(FontWeight.Bold)
        
        Text(this.selectedNote.content)
          .fontSize(16)
          .lineHeight(24)
        
        Blank()
        
        Row({ space: 10 }) {
          Button('ç¼–è¾‘')
            .onClick(() => {
              this.editNote(this.selectedNote!)
            })
          
          Button('åˆ é™¤')
            .backgroundColor(Color.Red)
            .onClick(() => {
              this.deleteNote(this.selectedNote!)
            })
        }
      }
      .padding(30)
      .alignItems(HorizontalAlign.Start)
    } else {
      Column() {
        Text('é€‰æ‹©ä¸€æ¡ç¬”è®°æŸ¥çœ‹')
          .fontSize(18)
          .fontColor(Color.Gray)
      }
      .width('100%')
      .height('100%')
      .justifyContent(FlexAlign.Center)
    }
  }
  
  createNote() {
    const newNote: Note = {
      id: Date.now().toString(),
      title: 'æ–°ç¬”è®°',
      content: '',
      timestamp: Date.now()
    }
    
    this.notes.push(newNote)
    this.distributedObj['notes'] = this.notes
    this.selectNote(newNote)
  }
  
  editNote(note: Note) {
    // å®ç°ç¼–è¾‘é€»è¾‘
  }
  
  deleteNote(note: Note) {
    this.notes = this.notes.filter(n => n.id !== note.id)
    this.distributedObj['notes'] = this.notes
    this.selectedNote = null
  }
}

interface Note {
  id: string
  title: string
  content: string
  timestamp: number
}

interface DeviceInfo {
  deviceId: string
  deviceName: string
  deviceType: number
}
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. è®¾å¤‡èƒ½åŠ›æ£€æµ‹

```typescript
function getDeviceCapabilities() {
  const deviceInfo = deviceManager.getDeviceInfo()
  
  return {
    hasCamera: deviceInfo.hasCamera,
    hasBluetooth: deviceInfo.hasBluetooth,
    screenSize: deviceInfo.screenSize,
    deviceType: deviceInfo.deviceType
  }
}
```

### 2. è‡ªé€‚åº”å¸ƒå±€

```typescript
// âœ… ä½¿ç”¨æ–­ç‚¹ç³»ç»Ÿ
GridRow({
  breakpoints: {
    value: ['sm', 'md', 'lg'],
    reference: BreakpointsReference.WindowSize
  }
}) {
  GridCol({ span: { sm: 12, md: 6, lg: 4 } }) {
    // å†…å®¹
  }
}
```

### 3. å¤šè®¾å¤‡æµ‹è¯•

```typescript
// ä½¿ç”¨ DevEco Studio å¤šè®¾å¤‡é¢„è§ˆ
// åŒæ—¶æŸ¥çœ‹æ‰‹æœºã€å¹³æ¿ã€æŠ˜å å±æ•ˆæœ
```

## ğŸ“š å‚è€ƒèµ„æº

- [ä¸€å¤šèƒ½åŠ›](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-preview-0000001337571249-V5)
- [åˆ†å¸ƒå¼è®¾å¤‡ç®¡ç†](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/device-management-overview-0000001774279934-V5)

---

**ç¬¬10ç« å®Œæˆï¼** ç»§ç»­å­¦ä¹  â†’ [ç¬¬11ç« ï¼šå›¾å½¢ä¸åŠ¨ç”»](../11-graphics-animation/)
