---
title: é¡µé¢æ ˆç®¡ç†
date: 2025-01-22
prevChapter: "harmonyos-dev/06-navigation-router/01-Navigationç»„ä»¶"
nextChapter: "harmonyos-dev/06-navigation-router/03-è·¯ç”±å‚æ•°ä¼ é€’"
parentChapter: "harmonyos-dev/06-navigation-router/README"
---
# é¡µé¢æ ˆç®¡ç†

> æŒæ¡ Navigation é¡µé¢æ ˆæ“ä½œ

## ğŸ“š é¡µé¢æ ˆæ¦‚å¿µ

### æ ˆç»“æ„

```
é¡µé¢æ ˆï¼ˆåè¿›å…ˆå‡ºï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Page C     â”‚ â† æ ˆé¡¶ï¼ˆå½“å‰é¡µé¢ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Page B     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Page A     â”‚ â† æ ˆåº•ï¼ˆé¦–é¡µï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ é¡µé¢æ ˆæ“ä½œ

### 1. pushPath - æ¨å…¥æ–°é¡µé¢

```typescript
@Entry
@Component
struct HomePage {
  pageStack: NavPathStack = new NavPathStack()
  
  build() {
    Navigation(this.pageStack) {
      Column() {
        Button('è·³è½¬åˆ°è¯¦æƒ…')
          .onClick(() => {
            // æ¨å…¥æ–°é¡µé¢
            this.pageStack.pushPath({ name: 'DetailPage' })
          })
        
        Button('è·³è½¬å¹¶ä¼ å‚')
          .onClick(() => {
            this.pageStack.pushPath({
              name: 'DetailPage',
              param: { id: 123, title: 'å•†å“è¯¦æƒ…' }
            })
          })
      }
    }
  }
}
```

### 2. pop - è¿”å›ä¸Šä¸€é¡µ

```typescript
Button('è¿”å›')
  .onClick(() => {
    // è¿”å›ä¸Šä¸€é¡µ
    this.pageStack.pop()
  })

Button('è¿”å›å¹¶ä¼ é€’ç»“æœ')
  .onClick(() => {
    // è¿”å›å¹¶ä¼ é€’æ•°æ®
    this.pageStack.pop({
      success: true,
      data: 'å¤„ç†ç»“æœ'
    })
  })
```

### 3. popToName - è¿”å›åˆ°æŒ‡å®šé¡µé¢

```typescript
Button('è¿”å›åˆ°é¦–é¡µ')
  .onClick(() => {
    // è¿”å›åˆ°æŒ‡å®šåç§°çš„é¡µé¢
    this.pageStack.popToName('HomePage')
  })
```

### 4. popToIndex - è¿”å›åˆ°æŒ‡å®šç´¢å¼•

```typescript
Button('è¿”å›åˆ°ç¬¬ä¸€ä¸ªé¡µé¢')
  .onClick(() => {
    // è¿”å›åˆ°æ ˆåº•ï¼ˆç´¢å¼•0ï¼‰
    this.pageStack.popToIndex(0)
  })
```

### 5. clear - æ¸…ç©ºé¡µé¢æ ˆ

```typescript
Button('æ¸…ç©ºå¹¶è¿”å›é¦–é¡µ')
  .onClick(() => {
    // æ¸…ç©ºæ‰€æœ‰é¡µé¢
    this.pageStack.clear()
  })
```

### 6. replacePath - æ›¿æ¢å½“å‰é¡µé¢

```typescript
Button('æ›¿æ¢ä¸ºç™»å½•é¡µ')
  .onClick(() => {
    // æ›¿æ¢å½“å‰é¡µé¢ï¼ˆä¸å¯è¿”å›ï¼‰
    this.pageStack.replacePath({ name: 'LoginPage' })
  })
```

## ğŸ“Š é¡µé¢æ ˆæŸ¥è¯¢

### è·å–æ ˆä¿¡æ¯

```typescript
@Entry
@Component
struct StackInfo {
  pageStack: NavPathStack = new NavPathStack()
  
  showStackInfo() {
    // è·å–æ ˆå¤§å°
    const size = this.pageStack.size()
    console.log('é¡µé¢æ ˆå¤§å°:', size)
    
    // è·å–æ‰€æœ‰è·¯å¾„åç§°
    const names = this.pageStack.getAllPathName()
    console.log('æ‰€æœ‰é¡µé¢:', names)
    
    // è·å–æŒ‡å®šç´¢å¼•çš„å‚æ•°
    const param = this.pageStack.getParamByIndex(0)
    console.log('é¦–é¡µå‚æ•°:', param)
    
    // è·å–æŒ‡å®šåç§°çš„å‚æ•°
    const detailParam = this.pageStack.getParamByName('DetailPage')
    console.log('è¯¦æƒ…é¡µå‚æ•°:', detailParam)
  }
  
  build() {
    Navigation(this.pageStack) {
      Column() {
        Button('æŸ¥çœ‹æ ˆä¿¡æ¯')
          .onClick(() => {
            this.showStackInfo()
          })
      }
    }
  }
}
```

## ğŸ”™ è¿”å›æ‹¦æˆª

### onBackPressed æ‹¦æˆªè¿”å›

```typescript
@Component
struct EditPage {
  @State hasUnsavedChanges: boolean = true
  pageStack: NavPathStack = new NavPathStack()
  
  build() {
    NavDestination() {
      Column() {
        TextInput({ placeholder: 'ç¼–è¾‘å†…å®¹' })
          .onChange(() => {
            this.hasUnsavedChanges = true
          })
        
        Button('ä¿å­˜')
          .onClick(() => {
            this.hasUnsavedChanges = false
            this.pageStack.pop()
          })
      }
    }
    .title('ç¼–è¾‘')
    .onBackPressed(() => {
      // æ‹¦æˆªè¿”å›
      if (this.hasUnsavedChanges) {
        AlertDialog.show({
          title: 'æç¤º',
          message: 'æœ‰æœªä¿å­˜çš„ä¿®æ”¹ï¼Œç¡®å®šè¦é€€å‡ºå—ï¼Ÿ',
          primaryButton: {
            value: 'å–æ¶ˆ',
            action: () => {}
          },
          secondaryButton: {
            value: 'ç¡®å®š',
            action: () => {
              this.pageStack.pop()
            }
          }
        })
        return true  // æ‹¦æˆªè¿”å›
      }
      return false  // å…è®¸è¿”å›
    })
  }
}
```

## ğŸ“± å®æˆ˜æ¡ˆä¾‹

### ç”µå•†åº”ç”¨å¯¼èˆª

```typescript
// ä¸»é¡µ
@Entry
@Component
struct ShopHome {
  pageStack: NavPathStack = new NavPathStack()
  
  build() {
    Navigation(this.pageStack) {
      Column() {
        // å•†å“åˆ—è¡¨
        List() {
          ForEach([1, 2, 3, 4], (item: number) => {
            ListItem() {
              Row() {
                Text(`å•†å“ ${item}`)
                  .layoutWeight(1)
                
                Button('æŸ¥çœ‹')
                  .onClick(() => {
                    this.pageStack.pushPath({
                      name: 'ProductDetail',
                      param: { productId: item }
                    })
                  })
              }
              .padding(15)
            }
          })
        }
      }
    }
    .title('å•†åŸé¦–é¡µ')
  }
}

// å•†å“è¯¦æƒ…é¡µ
@Component
struct ProductDetail {
  pageStack: NavPathStack = new NavPathStack()
  @State productId: number = 0
  
  build() {
    NavDestination() {
      Column({ space: 20 }) {
        Text(`å•†å“ID: ${this.productId}`)
          .fontSize(20)
        
        Button('åŠ å…¥è´­ç‰©è½¦')
          .onClick(() => {
            // è¿”å›å¹¶ä¼ é€’ç»“æœ
            this.pageStack.pop({
              action: 'addToCart',
              productId: this.productId
            })
          })
        
        Button('ç«‹å³è´­ä¹°')
          .onClick(() => {
            // è·³è½¬åˆ°è®¢å•ç¡®è®¤é¡µ
            this.pageStack.pushPath({
              name: 'OrderConfirm',
              param: { productId: this.productId }
            })
          })
        
        Button('è¿”å›é¦–é¡µ')
          .onClick(() => {
            // æ¸…ç©ºæ ˆï¼Œå›åˆ°é¦–é¡µ
            this.pageStack.clear()
          })
      }
      .padding(20)
    }
    .title('å•†å“è¯¦æƒ…')
    .onReady((context) => {
      const param = context.pathStack.getParamByName('ProductDetail')
      this.productId = param?.productId || 0
    })
  }
}

// è®¢å•ç¡®è®¤é¡µ
@Component
struct OrderConfirm {
  pageStack: NavPathStack = new NavPathStack()
  @State productId: number = 0
  
  submitOrder() {
    // æäº¤è®¢å•æˆåŠŸåï¼Œè¿”å›åˆ°é¦–é¡µ
    this.pageStack.clear()
    
    // æˆ–è€…è¿”å›åˆ°æŒ‡å®šé¡µé¢
    // this.pageStack.popToName('ShopHome')
  }
  
  build() {
    NavDestination() {
      Column({ space: 20 }) {
        Text('è®¢å•ç¡®è®¤')
          .fontSize(24)
        
        Text(`å•†å“ID: ${this.productId}`)
        
        Button('æäº¤è®¢å•')
          .onClick(() => {
            this.submitOrder()
          })
      }
      .padding(20)
    }
    .title('è®¢å•ç¡®è®¤')
    .onReady((context) => {
      const param = context.pathStack.getParamByName('OrderConfirm')
      this.productId = param?.productId || 0
    })
  }
}
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. åˆç†ç®¡ç†é¡µé¢æ ˆ

```typescript
// âœ… ç™»å½•åæ¸…ç©ºä¹‹å‰çš„é¡µé¢
loginSuccess() {
  this.pageStack.clear()
  this.pageStack.pushPath({ name: 'HomePage' })
}

// âœ… æ”¯ä»˜æˆåŠŸåè¿”å›åˆ°è®¢å•åˆ—è¡¨
paymentSuccess() {
  this.pageStack.popToName('OrderList')
}
```

### 2. é¿å…é¡µé¢æ ˆè¿‡æ·±

```typescript
// âŒ é¿å…
HomePage â†’ DetailA â†’ DetailB â†’ DetailC â†’ DetailD (å¤ªæ·±)

// âœ… ä½¿ç”¨ replacePath ä¼˜åŒ–
HomePage â†’ DetailA â†’ DetailB (æ›¿æ¢) â†’ DetailC
```

### 3. å¤„ç†è¿”å›ç»“æœ

```typescript
// é¡µé¢ A - ç­‰å¾…è¿”å›ç»“æœ
this.pageStack.pushPath({
  name: 'SelectPage',
  onPop: (result) => {
    console.log('è¿”å›ç»“æœ:', result)
    if (result?.selected) {
      this.handleSelection(result.selected)
    }
  }
})

// é¡µé¢ B - è¿”å›ç»“æœ
this.pageStack.pop({
  selected: this.selectedItem
})
```

## ğŸ“š å‚è€ƒèµ„æº

- [Navigation å®˜æ–¹æ–‡æ¡£](https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-basic-components-navigation-0000001815767556-V5)

---

**ä¸‹ä¸€èŠ‚** â†’ [è·¯ç”±å‚æ•°ä¼ é€’](03-è·¯ç”±å‚æ•°ä¼ é€’.md)
