---
title: è·¯ç”±å‚æ•°ä¼ é€’
date: 2025-01-22
prevChapter: "harmonyos-dev/06-navigation-router/02-é¡µé¢æ ˆç®¡ç†"
parentChapter: "harmonyos-dev/06-navigation-router/README"
---
# è·¯ç”±å‚æ•°ä¼ é€’

> åœ¨é¡µé¢é—´å®‰å…¨ä¼ é€’æ•°æ®

## ğŸ“¦ åŸºç¡€å‚æ•°ä¼ é€’

### ç®€å•ç±»å‹

```typescript
// ä¼ é€’å­—ç¬¦ä¸²å’Œæ•°å­—
this.pageStack.pushPath({
  name: 'DetailPage',
  param: {
    id: 123,
    title: 'å•†å“è¯¦æƒ…',
    price: 99.99
  }
})

// æ¥æ”¶å‚æ•°
@Component
struct DetailPage {
  @State id: number = 0
  @State title: string = ''
  @State price: number = 0
  
  build() {
    NavDestination() {
      Column() {
        Text(`ID: ${this.id}`)
        Text(`æ ‡é¢˜: ${this.title}`)
        Text(`ä»·æ ¼: Â¥${this.price}`)
      }
    }
    .onReady((context) => {
      const param = context.pathStack.getParamByName('DetailPage')
      if (param) {
        this.id = param.id
        this.title = param.title
        this.price = param.price
      }
    })
  }
}
```

### å¤æ‚å¯¹è±¡

```typescript
interface Product {
  id: number
  name: string
  price: number
  tags: string[]
  images: string[]
}

// ä¼ é€’å¯¹è±¡
const product: Product = {
  id: 1,
  name: 'iPhone 15',
  price: 5999,
  tags: ['çƒ­é”€', 'æ–°å“'],
  images: ['img1.jpg', 'img2.jpg']
}

this.pageStack.pushPath({
  name: 'ProductDetail',
  param: { product }
})

// æ¥æ”¶å¯¹è±¡
@Component
struct ProductDetail {
  @State product: Product = null
  
  build() {
    NavDestination() {
      Column({ space: 15 }) {
        Text(this.product?.name)
          .fontSize(24)
        
        Text(`Â¥${this.product?.price}`)
          .fontSize(20)
          .fontColor(Color.Red)
        
        Row() {
          ForEach(this.product?.tags || [], (tag: string) => {
            Text(tag)
              .padding(5)
              .backgroundColor(Color.Blue)
              .fontColor(Color.White)
              .borderRadius(4)
          })
        }
      }
    }
    .onReady((context) => {
      const param = context.pathStack.getParamByName('ProductDetail')
      this.product = param?.product
    })
  }
}
```

## ğŸ”„ åŒå‘ä¼ é€’

### å¸¦å›è°ƒçš„å‚æ•°ä¼ é€’

```typescript
// é¡µé¢ A - ä¼ é€’å›è°ƒ
@Entry
@Component
struct PageA {
  pageStack: NavPathStack = new NavPathStack()
  @State selectedColor: string = ''
  
  openColorPicker() {
    this.pageStack.pushPath({
      name: 'ColorPicker',
      param: {
        currentColor: this.selectedColor,
        onColorSelected: (color: string) => {
          this.selectedColor = color
        }
      }
    })
  }
  
  build() {
    Navigation(this.pageStack) {
      Column() {
        Text(`é€‰æ‹©çš„é¢œè‰²: ${this.selectedColor}`)
        
        Button('é€‰æ‹©é¢œè‰²')
          .onClick(() => {
            this.openColorPicker()
          })
      }
    }
  }
}

// é¡µé¢ B - ä½¿ç”¨å›è°ƒ
@Component
struct ColorPicker {
  pageStack: NavPathStack = new NavPathStack()
  @State colors: string[] = ['Red', 'Blue', 'Green', 'Yellow']
  private onColorSelected: (color: string) => void
  
  build() {
    NavDestination() {
      Column() {
        ForEach(this.colors, (color: string) => {
          Button(color)
            .width('100%')
            .onClick(() => {
              // è°ƒç”¨å›è°ƒ
              if (this.onColorSelected) {
                this.onColorSelected(color)
              }
              // è¿”å›ä¸Šä¸€é¡µ
              this.pageStack.pop()
            })
        })
      }
    }
    .onReady((context) => {
      const param = context.pathStack.getParamByName('ColorPicker')
      this.onColorSelected = param?.onColorSelected
    })
  }
}
```

### é€šè¿‡ pop è¿”å›æ•°æ®

```typescript
// é¡µé¢ A - ç­‰å¾…è¿”å›ç»“æœ
@Entry
@Component
struct PageA {
  pageStack: NavPathStack = new NavPathStack()
  @State result: string = ''
  
  openSelector() {
    this.pageStack.pushPath({
      name: 'Selector',
      onPop: (popResult) => {
        console.log('è¿”å›ç»“æœ:', popResult)
        if (popResult?.selected) {
          this.result = popResult.selected
        }
      }
    })
  }
  
  build() {
    Navigation(this.pageStack) {
      Column() {
        Text(`é€‰æ‹©ç»“æœ: ${this.result}`)
        
        Button('æ‰“å¼€é€‰æ‹©å™¨')
          .onClick(() => {
            this.openSelector()
          })
      }
    }
  }
}

// é¡µé¢ B - è¿”å›æ•°æ®
@Component
struct Selector {
  pageStack: NavPathStack = new NavPathStack()
  @State items: string[] = ['Option 1', 'Option 2', 'Option 3']
  
  selectItem(item: string) {
    // è¿”å›é€‰æ‹©ç»“æœ
    this.pageStack.pop({
      selected: item
    })
  }
  
  build() {
    NavDestination() {
      List() {
        ForEach(this.items, (item: string) => {
          ListItem() {
            Text(item)
              .width('100%')
              .padding(15)
              .onClick(() => {
                this.selectItem(item)
              })
          }
        })
      }
    }
  }
}
```

## ğŸ¯ ç±»å‹å®‰å…¨

### ä½¿ç”¨æ¥å£å®šä¹‰å‚æ•°

```typescript
// å®šä¹‰å‚æ•°æ¥å£
interface UserDetailParams {
  userId: number
  showEdit?: boolean
}

interface UserDetailResult {
  updated: boolean
  user?: User
}

// ç±»å‹å®‰å…¨çš„ä¼ é€’
function navigateToUserDetail(userId: number) {
  const params: UserDetailParams = {
    userId,
    showEdit: true
  }
  
  this.pageStack.pushPath({
    name: 'UserDetail',
    param: params,
    onPop: (result: UserDetailResult) => {
      if (result?.updated) {
        console.log('ç”¨æˆ·å·²æ›´æ–°:', result.user)
      }
    }
  })
}

// ç±»å‹å®‰å…¨çš„æ¥æ”¶
@Component
struct UserDetail {
  @State userId: number = 0
  @State showEdit: boolean = false
  
  build() {
    NavDestination() {
      Column() {
        Text(`ç”¨æˆ·ID: ${this.userId}`)
        
        if (this.showEdit) {
          Button('ç¼–è¾‘')
        }
      }
    }
    .onReady((context) => {
      const params = context.pathStack.getParamByName('UserDetail') as UserDetailParams
      if (params) {
        this.userId = params.userId
        this.showEdit = params.showEdit ?? false
      }
    })
  }
}
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. é¿å…ä¼ é€’å¤§å¯¹è±¡

```typescript
// âŒ é¿å…ä¼ é€’å¤§é‡æ•°æ®
this.pageStack.pushPath({
  name: 'Detail',
  param: {
    largeArray: Array.from({ length: 10000 }, () => ({ /* å¤§å¯¹è±¡ */ }))
  }
})

// âœ… åªä¼ é€’ IDï¼Œåœ¨ç›®æ ‡é¡µé¢åŠ è½½æ•°æ®
this.pageStack.pushPath({
  name: 'Detail',
  param: { id: 123 }
})

// ç›®æ ‡é¡µé¢
async aboutToAppear() {
  this.data = await loadDataById(this.id)
}
```

### 2. ä½¿ç”¨ AppStorage å…±äº«çŠ¶æ€

```typescript
// è®¾ç½®å…±äº«æ•°æ®
AppStorage.SetOrCreate('selectedItems', [1, 2, 3])

// è·³è½¬ï¼ˆä¸ä¼ å‚ï¼‰
this.pageStack.pushPath({ name: 'Detail' })

// è¯»å–å…±äº«æ•°æ®
@StorageLink('selectedItems') selectedItems: number[] = []
```

### 3. å‚æ•°éªŒè¯

```typescript
build() {
  NavDestination() {
    Column() {
      if (this.isValidParams()) {
        // æ˜¾ç¤ºå†…å®¹
        Content()
      } else {
        // æ˜¾ç¤ºé”™è¯¯
        Text('å‚æ•°é”™è¯¯')
      }
    }
  }
  .onReady((context) => {
    const params = context.pathStack.getParamByName('Detail')
    this.loadParams(params)
  })
}

isValidParams(): boolean {
  return this.id > 0 && this.title !== ''
}
```

## ğŸ“š å‚è€ƒèµ„æº

- [Navigation å‚æ•°ä¼ é€’](https://developer.harmonyos.com/cn/docs/documentation/doc-guides-V3/arkts-routing-0000001503325125-V3)

---

**ç¬¬6ç« å®Œæˆï¼** ç»§ç»­å­¦ä¹  â†’ [ç¬¬7ç« ï¼šæ•°æ®ç®¡ç†](../07-data-management/)
