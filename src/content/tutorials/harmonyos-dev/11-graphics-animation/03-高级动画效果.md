---
title: é«˜çº§åŠ¨ç”»æ•ˆæœ
date: 2025-01-22
prevChapter: "harmonyos-dev/11-graphics-animation/02-Canvasç»˜å›¾"
parentChapter: "harmonyos-dev/11-graphics-animation/README"
---
# é«˜çº§åŠ¨ç”»æ•ˆæœ

> å®ç°å¤æ‚çš„åŠ¨ç”»æ•ˆæœ

## ğŸ¬ ç»„åˆåŠ¨ç”»

### åºåˆ—åŠ¨ç”»

```typescript
@Entry
@Component
struct SequenceAnimation {
  @State scale: number = 1
  @State opacity: number = 1
  @State rotate: number = 0
  
  async runSequence() {
    // æ­¥éª¤1ï¼šæ”¾å¤§
    animateTo({ duration: 500 }, () => {
      this.scale = 1.5
    })
    await this.delay(500)
    
    // æ­¥éª¤2ï¼šæ·¡å‡º
    animateTo({ duration: 500 }, () => {
      this.opacity = 0.3
    })
    await this.delay(500)
    
    // æ­¥éª¤3ï¼šæ—‹è½¬
    animateTo({ duration: 500 }, () => {
      this.rotate = 360
    })
    await this.delay(500)
    
    // é‡ç½®
    animateTo({ duration: 500 }, () => {
      this.scale = 1
      this.opacity = 1
      this.rotate = 0
    })
  }
  
  delay(ms: number): Promise<void> {
    return new Promise(resolve => setTimeout(resolve, ms))
  }
  
  build() {
    Column() {
      Column()
        .width(100)
        .height(100)
        .backgroundColor(Color.Blue)
        .scale({ x: this.scale, y: this.scale })
        .opacity(this.opacity)
        .rotate({ angle: this.rotate })
      
      Button('å¼€å§‹åºåˆ—åŠ¨ç”»')
        .margin({ top: 100 })
        .onClick(() => {
          this.runSequence()
        })
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Center)
  }
}
```

### å¹¶è¡ŒåŠ¨ç”»

```typescript
@Entry
@Component
struct ParallelAnimation {
  @State x: number = 0
  @State y: number = 0
  @State rotate: number = 0
  @State scale: number = 1
  
  runParallel() {
    animateTo({
      duration: 1000,
      curve: Curve.EaseInOut
    }, () => {
      this.x = 100
      this.y = 100
      this.rotate = 360
      this.scale = 1.5
    })
  }
  
  build() {
    Column() {
      Column()
        .width(80)
        .height(80)
        .backgroundColor(Color.Red)
        .translate({ x: this.x, y: this.y })
        .rotate({ angle: this.rotate })
        .scale({ x: this.scale, y: this.scale })
      
      Button('å¹¶è¡ŒåŠ¨ç”»')
        .margin({ top: 200 })
        .onClick(() => {
          this.runParallel()
        })
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Center)
  }
}
```

## ğŸ–ï¸ æ‰‹åŠ¿åŠ¨ç”»

### æ‹–æ‹½åŠ¨ç”»

```typescript
@Entry
@Component
struct DragAnimation {
  @State offsetX: number = 0
  @State offsetY: number = 0
  
  build() {
    Column() {
      Column()
        .width(100)
        .height(100)
        .backgroundColor(Color.Blue)
        .translate({ x: this.offsetX, y: this.offsetY })
        .gesture(
          PanGesture()
            .onActionUpdate((event: GestureEvent) => {
              this.offsetX = event.offsetX
              this.offsetY = event.offsetY
            })
            .onActionEnd(() => {
              // å›å¼¹åŠ¨ç”»
              animateTo({
                duration: 500,
                curve: Curve.Spring
              }, () => {
                this.offsetX = 0
                this.offsetY = 0
              })
            })
        )
      
      Text('æ‹–æ‹½æ–¹å—ï¼Œæ¾æ‰‹å›å¼¹')
        .margin({ top: 200 })
        .fontSize(16)
        .fontColor(Color.Gray)
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Center)
  }
}
```

### æåˆç¼©æ”¾

```typescript
@Entry
@Component
struct PinchAnimation {
  @State scale: number = 1
  
  build() {
    Column() {
      Image($r('app.media.image'))
        .width(200)
        .height(200)
        .scale({ x: this.scale, y: this.scale })
        .gesture(
          PinchGesture()
            .onActionUpdate((event: GestureEvent) => {
              this.scale = event.scale
            })
            .onActionEnd(() => {
              // é™åˆ¶ç¼©æ”¾èŒƒå›´
              animateTo({ duration: 300 }, () => {
                if (this.scale < 0.5) {
                  this.scale = 0.5
                } else if (this.scale > 3) {
                  this.scale = 3
                }
              })
            })
        )
      
      Text(`ç¼©æ”¾: ${this.scale.toFixed(2)}x`)
        .margin({ top: 20 })
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Center)
  }
}
```

## ğŸŒŠ ç‰©ç†åŠ¨ç”»

### å¼¹ç°§åŠ¨ç”»

```typescript
@Entry
@Component
struct SpringAnimation {
  @State offset: number = 0
  
  bounce() {
    animateTo({
      duration: 800,
      curve: Curve.Spring,
      iterations: 1
    }, () => {
      this.offset = this.offset === 0 ? 200 : 0
    })
  }
  
  build() {
    Column() {
      Column()
        .width(60)
        .height(60)
        .backgroundColor(Color.Red)
        .borderRadius(30)
        .translate({ y: this.offset })
      
      Button('å¼¹è·³')
        .margin({ top: 300 })
        .onClick(() => {
          this.bounce()
        })
    }
    .width('100%')
    .height('100%')
    .padding({ top: 100 })
  }
}
```

## ğŸ¯ å®æˆ˜æ¡ˆä¾‹ï¼šåŠ è½½åŠ¨ç”»

```typescript
@Entry
@Component
struct LoadingAnimation {
  @State rotate: number = 0
  @State isLoading: boolean = false
  private timer: number = -1
  
  startLoading() {
    this.isLoading = true
    this.timer = setInterval(() => {
      animateTo({
        duration: 800,
        curve: Curve.Linear
      }, () => {
        this.rotate += 360
      })
    }, 800)
  }
  
  stopLoading() {
    this.isLoading = false
    clearInterval(this.timer)
    this.rotate = 0
  }
  
  build() {
    Column({ space: 30 }) {
      // åŠ è½½å›¾æ ‡
      LoadIcon()
        .width(60)
        .height(60)
        .rotate({ angle: this.rotate })
        .visibility(this.isLoading ? Visibility.Visible : Visibility.Hidden)
      
      Text(this.isLoading ? 'åŠ è½½ä¸­...' : 'å·²å®Œæˆ')
        .fontSize(18)
      
      Row({ space: 10 }) {
        Button('å¼€å§‹åŠ è½½')
          .onClick(() => {
            this.startLoading()
          })
        
        Button('åœæ­¢')
          .onClick(() => {
            this.stopLoading()
          })
      }
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Center)
  }
}

@Component
struct LoadIcon {
  build() {
    Stack() {
      ForEach([0, 45, 90, 135, 180, 225, 270, 315], (angle: number, index: number) => {
        Column()
          .width(4)
          .height(15)
          .backgroundColor(Color.Blue)
          .borderRadius(2)
          .opacity(0.3 + (index * 0.1))
          .rotate({ angle: angle })
          .translate({ y: -20 })
      })
    }
    .width(60)
    .height(60)
  }
}
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æ€§èƒ½ä¼˜åŒ–

```typescript
// âœ… ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿå±æ€§
.translate()
.scale()
.rotate()
.opacity()

// âœ… é¿å…åŠ¨ç”»æœŸé—´é‡æ–°å¸ƒå±€
// âŒ ä¸è¦åœ¨åŠ¨ç”»ä¸­ä¿®æ”¹ width/height
```

### 2. åŠ¨ç”»æµç•…åº¦

```typescript
// âœ… 60fps åŠ¨ç”»æŒç»­æ—¶é—´
const duration = Math.ceil(distance / 60) * 16.67

// âœ… ä½¿ç”¨åˆé€‚çš„ç¼“åŠ¨å‡½æ•°
curve: Curve.EaseInOut  // è‡ªç„¶è¿‡æ¸¡
```

### 3. åŠ¨ç”»å–æ¶ˆ

```typescript
private animationId: number = -1

startAnimation() {
  if (this.animationId >= 0) {
    // å–æ¶ˆä¹‹å‰çš„åŠ¨ç”»
    cancelAnimationFrame(this.animationId)
  }
  
  this.animationId = requestAnimationFrame(() => {
    // åŠ¨ç”»é€»è¾‘
  })
}
```

## ğŸ“š å‚è€ƒèµ„æº

- [åŠ¨ç”»æ¦‚è¿°](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-animation-overview-0000001820880269-V5)
- [æ‰‹åŠ¿äº‹ä»¶](https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-gesture-settings-0000001815767612-V5)

---

**ç¬¬11ç« å®Œæˆï¼** ç»§ç»­å­¦ä¹  â†’ [ç¬¬12ç« ï¼šå¤šåª’ä½“å¢å¼º](../12-multimedia-next/)
